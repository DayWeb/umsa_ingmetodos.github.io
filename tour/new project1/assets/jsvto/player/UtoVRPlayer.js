/*! nan出品，必出精品 */!function(t){var e={};function i(n){if(e[n])return e[n].exports;var r=e[n]={i:n,l:!1,exports:{}};return t[n].call(r.exports,r,r.exports,i),r.l=!0,r.exports}i.m=t,i.c=e,i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:n})},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=0)}([function(t,e,i){var n;window.JTUtil={gId:function(t){return document.getElementById(t)?document.getElementById(t):null},gName:function(t){return document.getElementsByTagName(t)?document.getElementsByTagName(t):null},contains:function(t,e){return!!t&&(t.contains?t!=e&&t.contains(e):!!(16&t.compareDocumentPosition(arg)))},insertAfter:function(t,e){var i=e.parentNode;i.lastChild==e?i.appendChild(t):i.insertBefore(t,e.nextSibling)},insertBefore:function(t,e){e.parentNode.insertBefore(t,e)},cDom:function(t){return document.createElement(t)},lScript:function(t,e,i,n){var r=JTUtil.cDom("script");r.name=t,r.type="text/javascript",r.src=e,r.charset="utf-8",r.onload=function(){this.readyState&&"loaded"!=this.readyState&&"complete"!=this.readyState||(i&&n?i.call(n):i&&i())},this.gName("head")[0].appendChild(r)},lCss:function(t,e,i,n){var r=JTUtil.cDom("link");r.name=t,r.type="text/css",r.rel="stylesheet",r.charset="utf-8",r.href=e,r.onload=function(){i&&n?i.call(n):i&&i()},this.gName("head")[0].appendChild(r)},getBrowser:function(){var t=navigator.userAgent.toLowerCase(),e=(t.match(/firefox|chrome|safari|opera/g)||"other")[0];(t.match(/edge|msie|trident/g)||[])[0]&&(e="msie");var i,n="pc",r="";switch("ontouchstart"in window||-1!=t.indexOf("touch")||-1!=t.indexOf("mobile")?-1!==t.indexOf("ipad")?n="pad":-1!==t.indexOf("mobile")?n="mobile":-1!==t.indexOf("android")&&(n="androidPad"):n="pc",e){case"chrome":case"safari":case"mobile":r="webkit";break;case"msie":r="ms";break;case"firefox":r="Moz";break;case"opera":r="O";break;default:r="webkit"}return i=t.indexOf("android")>0?"android":navigator.platform.toLowerCase(),{version:(t.match(/[\s\S]+(?:rv|it|ra|ie)[\/: ]([\d.]+)/)||[])[1],plat:i,type:e,pc:n,prefix:r,isMobile:"pc"!=n&&"other"!=n}},getLanguage:function(){var t=navigator.language;return"zh-CN"===t||"zh-cn"===t?"cn":"ja"===t?"jp":"en"},getWindowOrientation:function(){return 0==window.orientation||180==window.orientation?"Vertical":90==window.orientation||-90==window.orientation?"Horizontal":null},getWindowSize:function(){var t=this.getWindowOrientation(),e={position:{left:window.screenX||window.screenLeft,top:window.screenY||window.screenTop,width:window.screen.width,height:window.screen.height},width:document.documentElement.clientWidth||window.innerWidth||document.body.clientWidth,height:document.documentElement.clientHeight||window.innerHeight||document.body.clientHeight,viewPort:{width:document.documentElement.clientWidth||window.innerWidth||document.body.clientWidth,height:window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,horizontalScroll:window.pageXOffset||document.documentElement.scrollLeft||document.body.scrollLeft,verticalScroll:window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop},Document:{width:document.documentElement.scrollWidth||document.body.scrollWidth,height:document.documentElement.scrollHeight||document.body.scrollHeight}};if("pad"==this.getBrowser().pc&&"Horizontal"==t&&"safari"==this.getBrowser().type){var i=(navigator.userAgent.toLowerCase().match(/version\/[\d.]+/gi)+"").replace(/[^0-9.]/gi,"").split(".")[0]||8;i&&i<8&&(e.viewPort.height=e.viewPort.height-20)}return e},loadResource:function(t,e){var i=this.createXMLHttp(),n=t;i.open("GET",n,!0),i.send(),i.onreadystatechange=function(){if(4==i.readyState){var t=i.responseText||i.response;e&&"function"==typeof e&&e(t)}}},createXMLHttp:function(){if(window.ActiveXObject)for(var t=["MSXML2.XMLHttp.6.0","MSXML2.XMLHttp.5.0","MSXML2.XMLHttp.4.0","MSXML2.XMLHttp.3.0","MSXML2.XMLHttp","Microsoft.XMLHttp"],e=0;e<t.length;e++)try{return new ActiveXObject(t[e])}catch(t){}else try{return new XMLHttpRequest}catch(t){}},to16Hex:function(t){var e=t.toString(16);return 2==e.length?e:"0"+e},rndRGB:function(){var t=Math.floor(256*Math.random()),e=Math.floor(256*Math.random()),i=Math.floor(256*Math.random());return"#"+this.to16Hex(t)+this.to16Hex(e)+this.to16Hex(i)},rgbToHex:function(t,e,i){return"#"+this.to16Hex(t)+this.to16Hex(e)+this.to16Hex(i)},hexToRgb:function(t){if(7!=t.length)return[0,0,0];var e=t.substr(1,2),i=t.substr(3,2),n=t.substr(3,2);return[parseInt(e,16),parseInt(i,16),parseInt(n,16)]},argbToRgba:function(t){var e=t?t.split(","):"",i=(e[0]/255).toFixed(2);return e?"rgba("+e[1]+","+e[2]+","+e[3]+","+i+")":""},xmlParseToJSON:function(t,e){for(var i={},n=0;n<t.length;n++){var r=t[n],s=r.nodeName,a=null;if(3!=r.nodeType)if(a=0==r.childNodes.length?null:1==r.childNodes.length&&3==r.childNodes[0].nodeType?r.childNodes[0].nodeValue:this.xmlParseToJSON(r.childNodes,e),i[s])if("[object Array]"===Object.prototype.toString.call(i[s]))i[s].push(a);else{var o=i[s];i[s]=[],i[s].push(o),i[s].push(a)}else i[s]=a}return i},getXMLDOM:function(t){var e;window.ActiveXObject?((e=new ActiveXObject("Msxml2.DOMDocument")).async=!1,e.loadXML(t)):e=(new DOMParser).parseFromString(t,"text/xml");return e.documentElement},supportsStyle:function(t){var e=JTUtil.cDom("div"),i="Khtml Ms O Moz Webkit".split(" "),n=i.length;if(t in e.style)return!0;for(t=t.replace(/^[a-z]/,function(t){return t.toUpperCase()});n--;)if(i[n]+t in e.style)return!0;return!1},pluginCheck:function(){var t={},e={flash:{activex:"ShockwaveFlash.ShockwaveFlash",plugin:/flash/gim},pdf:{activex:"PDF.PdfCtrl",plugin:/adobe\s?acrobat/gim},java:{activex:navigator.javaEnabled(),plugin:/java/gim}},i=function(i){if(window.ActiveXObject)try{new ActiveXObject(e[i].activex),t[i]=!0}catch(e){t[i]=!1}else for(var n=0;n<navigator.plugins.length;n++){if(navigator.plugins[n].name.match(e[i].plugin))return t[i]=!0,!1;t[i]=!1}};for(var n in e)i(n);return t},support_WebGL:function(){if(window.WebGLRenderingContext){var t=document.createElement("canvas"),e=["webgl","experimental-webgl","moz-webgl","webkit-3d"];for(var i in e)try{if(t.getContext(e[i]))return!0}catch(t){}return!1}return!1},getWebGLInfo:function(){"use strict"},support_Css3D:function(){var t,e,i=!1,n=JTUtil.cDom("div");for(t=0;t<5;t++)if(void 0!==n.style[["p","msP","MozP","WebkitP","OP"][t]+"erspective"]){i=!0,3==t&&window.matchMedia&&((e=window.matchMedia("(-webkit-transform-3d)"))&&(i=1==e.matches));break}return i},registerCss:function(t){var e=JTUtil.cDom("style"),i=document.getElementsByTagName("head")[0];if(i)return document.all?(e.setAttribute("type","text/css"),e.styleSheet.cssText=t):e.appendChild(document.createTextNode(t)),i.firstChild?i.insertBefore(e,i.firstChild):i.appendChild(e),e},isSupportFullScreen:function(){var t=document.documentElement,e=navigator.userAgent.toLowerCase();return!/mqqbrowser\//i.test(e)&&("requestFullscreen"in t||"webkitRequestFullScreen"in t||"mozRequestFullScreen"in t&&document.mozFullScreenEnabled||!1)},isFullScreen:function(){var t=document;return t.msFullscreenElement||t.mozFullScreenElement||t.webkitFullscreenElement||t.webkitIsFullScreen||!1},reqFullScreen:function(t){var e=document.msFullscreenElement||document.mozFullScreenElement||document.webkitFullScreenElement||document.webkitIsFullScreen;t=t||document.documentElement;return e?(document.exitFullscreen&&document.exitFullscreen(),document.cancelFullScreen&&document.cancelFullScreen(),document.webkitCancelFullScreen&&document.webkitCancelFullScreen(),document.msExitFullscreen&&document.msExitFullscreen(),document.mozCancelFullScreen&&document.mozCancelFullScreen(),document.oCancelFullScreen&&document.oCancelFullScreen(),!1):(t.requestFullScreen&&t.requestFullScreen(),t.webkitRequestFullScreen&&t.webkitRequestFullScreen(),t.msRequestFullscreen&&t.msRequestFullscreen(),t.mozRequestFullScreen&&t.mozRequestFullScreen(),t.oRequestFullScreen&&t.oRequestFullScreen(),!0)},firstCharUpCase:function(t){for(var e="",i=0,n=(t=t||"").length;i<n;i++){var r=t.charAt(i);0==i?e=r.toUpperCase():e+=r.toLowerCase()}return e},setToArray:function(t){if(t&&"[object Array]"!=Object.prototype.toString.call(t)){var e=t,i=[];return i.push(e),i}return t},getBestFitSize:function(t,e,i,n){var r,s,a,o;return t/e>1?(r=i,(s=i/t*e)>n&&(r*=n/s,s=n),a=.5*(i-r),o=.5*(n-s)):(s=n,(r=n/e*t)>i&&(s*=i/r,r=i),a=.5*(i-r),o=.5*(n-s)),{width:r,height:s,left:a,top:o}},getCenterSize:function(t,e,i,n){return{width:t,height:e,top:.5*(n-e),left:.5*(i-t)}},setViewPort:function(t){if("pc"!==this.getBrowser().pc){var e=document.getElementsByName("viewport")[0];e||((e=JTUtil.cDom("meta")).name="viewport",document.getElementsByTagName("head")[0].appendChild(e));var i=t,n=navigator.userAgent.toLowerCase(),r=window.screen.width,s=/iphone|ipod/gi.test(navigator.platform),a="width=device-width,initial-scale=1.0,minimum-scale=1.0,maximum-scale=1.0,minimal-ui,target-densitydpi=device-dpi";if(!isNaN(i)&&(s&&(a=n.indexOf("version/6")>0||n.indexOf("iphone os 6")>0?"width=640, initial-scale=0.5, maximum-scale=0.5, minimum-scale=0.5,minimal-ui":"width="+i+"px, user-scalable=no, minimal-ui,initial-scale=0.5, maximum-scale=0.5, minimum-scale=0.5"),-1!==n.indexOf("android")&&(a="target-densitydpi=device-dpi, user-scalable=no",-1!==n.indexOf("mobile")))){a="target-densitydpi=device-dpi, width="+i+"px, user-scalable=no";var o=i/r*(window.devicePixelRatio||1)*160;parseFloat(n.slice(n.indexOf("android")+8))<4&&(a="target-densitydpi="+o+", width=device-width, user-scalable=no"),-1===n.indexOf("qq")&&-1===n.indexOf("micromessenger")||(a="target-densitydpi="+o+", width=device-width, user-scalable=no"),-1!==n.indexOf("firefox")&&(a="target-densitydpi=device-dpi, width="+i+"px, user-scalable=no")}return e.content=a,a}},getQueryString:function(t){t=t.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var e=new RegExp("[\\?&]"+t+"=([^&#]*)").exec(location.search);return null===e?"":decodeURIComponent(e[1].replace(/\+/g," "))},getFileExt:function(t){var e=(t=t).indexOf("?");e>0&&(t=t.substring(0,e));var i=/\.[^\.]+$/.exec(t);return i?i[0]:""},css3Animate:function(t,e,i,n){var r=t,s=JTUtil.getBrowser(),a=function(){n&&n(arguments),EventUtil.removeEvent(r,"transitionEnd",a),r.style[s.prefix+"Transition"]=""};EventUtil.addEvent(r,"transitionEnd",a);var o="";for(var h in e)o+=h+" "+i+"s,";for(var h in getComputedStyle(r).width,r.style[s.prefix+"Transition"]=o+"color 0s",e)r.style[h]=e[h]},formatToMin:function(t){var e=Math.floor(t/60);e=e<10?"0"+e:e;var i=Math.floor(t%60);return e+":"+(i=i<10?"0"+i:i)},getRandomNum:function(t,e){var i=e-t,n=Math.random();return t+Math.round(n*i)},toUnicodeByStr:function(t){for(var e=[],i=0;i<t.length;i++)e.push(t.charCodeAt(i));return e},toStrByUniCode:function(t){for(var e=[],i=0;i<t.length;i++)e.push(String.fromCharCode(t[i]));return e.join("")},isIFrame:function(){try{return window.self!==window.top}catch(t){return!0}},isPow2:function(t){return 0==(t&t-1)},isIOS:function(){return/(iPad|iPhone|iPod)/g.test(navigator.userAgent)},isMobile:function(){var t=!1;return function(e){(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4)))&&(t=!0)}(navigator.userAgent||navigator.vendor||window.opera),t},isEmptyObject:function(t){var e;for(e in t)return!1;return!0}},window.EventUtil={getEventName:function(t){var e;switch(JTUtil.getBrowser().prefix){case"webkit":"webkitTransitionEnd",e="webkitfullscreenchange";break;case"ms":"MSTransitionEnd",e="MSFullscreenChange";break;case"O":"otransitionend",e="ofullscreenchange";break;case"Moz":"transitionend",e="mozfullscreenchange";break;default:"transitionend",e="fullscreenchange"}return{mousewheel:/Firefox/i.test(navigator.userAgent)?"DOMMouseScroll":"mousewheel",fullScreenChange:e,resize:"resize"}[t]||t},addEvent:function(t,e,i,n){var r=this.getEventName(e),s=function(t){var e=EventUtil.getEvent(t);i.call(n,e,t)};return t.addEventListener?t.addEventListener(r,s,!1):t.attachEvent?t.attachEvent("on"+r,s):t["on"+r]=s,s},removeEvent:function(t,e,i){var n=this.getEventName(e);return t.removeEventListener?t.removeEventListener(n,i,!1):t.detachEvent?t.detachEvent("on"+n,i):t["on"+n]=null,t},getTarget:function(t){return t.target||t.srcElement},getEvent:function(t){return JTUtil.getBrowser().isMobile&&(EventUtil.stopDefault(t),EventUtil.stopPropagation(t)),t.changedTouches?t.changedTouches[0]:t||window.event},stopDefault:function(t){t.preventDefault?t.preventDefault():t.returnValue=!1},stopPropagation:function(t){t.stopPropagation?t.stopPropagation():t.cancelBubble=!0},getButton:function(t){if(document.implementation.hasFeature("MouseEvents","2.0"))return t.button;switch(t.button){case 0:return 0;case 2:case 6:return 2;case 4:return 1}},getEventSize:function(t){return{x:t.clientX,y:t.clientY}},getOffsetX:function(t){var e=t||window.event,i=e.target||e.srcElement;if(e.offsetX)return e.offsetX;var n=i.getBoundingClientRect();return e.clientX-n.left},getOffsetY:function(t){var e=t||window.event,i=e.target||e.srcElement;if(e.offsetY)return e.offsetY;var n=i.getBoundingClientRect();return e.clientY-n.top},throttle:function(t,e,i,n){var r,s,a,o=+new Date,h=0,l=0,c=null,u=function(){l=o,t.apply(s,a)};return function(){o=+new Date,s=this,a=arguments,r=o-(n?h:l)-e,clearTimeout(c),n?i?c=setTimeout(u,e):r>=0&&u():r>=0?u():i&&(c=setTimeout(u,-r)),h=o}},debounce:function(t,e,i){return this.throttle(t,e,i,!0)}},window.DomUtil={inject:function(t,e){return e&&e.appendChild(t),t},insertAfter:function(t,e){var i=e.parentNode;i.lastChild==e?i.appendChild(t):i.insertBefore(t,e.nextSibling)},insertBefore:function(t,e){e.parentNode.insertBefore(t,e)},setStyles:function(t,e){for(var i in e)t.style[i]=e[i];return t},getStyle:function(t,e){return void 0!==window.getComputedStyle?parseInt(window.getComputedStyle(t,null)[e]):t.currentStyle?parseInt(t.currentStyle[e]):void 0},setProperties:function(t,e){for(var i in e)t.setAttribute(i,e[i]);return t},destroy:function(t){t.parentNode&&t.parentNode.removeChild(t)},hasClass:function(t,e){return t.className.match(new RegExp("(\\s|^)"+e+"(\\s|$)"))},addClass:function(t,e){this.hasClass(t,e)||(t.className+=" "+e)},removeClass:function(t,e){if(this.hasClass(t,e)){var i=new RegExp("(\\s|^)"+e+"(\\s|$)");t.className=t.className.replace(i," ")}},getSize:function(t){var e=t.getBoundingClientRect(),i=e.top,n=e.bottom,r=e.left,s=e.right;return{top:i,left:r,right:s,bottom:n,width:e.width||s-r,height:e.height||n-i}}},function(t){"use strict";var i={};"undefined"!=typeof window?i.exports="undefined"!=typeof window?window:t:i.exports=e||{},function(t){if(!e)var e=1e-6;if(!i)var i="undefined"!=typeof Float32Array?Float32Array:Array;if(!n)var n=Math.random;var r={setMatrixArrayType:function(t){i=t}};void 0!==t&&(t.glMatrix=r);var s=Math.PI/180;r.toRadian=function(t){return t*s};var a={create:function(){var t=new i(2);return t[0]=0,t[1]=0,t},clone:function(t){var e=new i(2);return e[0]=t[0],e[1]=t[1],e},fromValues:function(t,e){var n=new i(2);return n[0]=t,n[1]=e,n},copy:function(t,e){return t[0]=e[0],t[1]=e[1],t},set:function(t,e,i){return t[0]=e,t[1]=i,t},add:function(t,e,i){return t[0]=e[0]+i[0],t[1]=e[1]+i[1],t},subtract:function(t,e,i){return t[0]=e[0]-i[0],t[1]=e[1]-i[1],t}};a.sub=a.subtract,a.multiply=function(t,e,i){return t[0]=e[0]*i[0],t[1]=e[1]*i[1],t},a.mul=a.multiply,a.divide=function(t,e,i){return t[0]=e[0]/i[0],t[1]=e[1]/i[1],t},a.div=a.divide,a.min=function(t,e,i){return t[0]=Math.min(e[0],i[0]),t[1]=Math.min(e[1],i[1]),t},a.max=function(t,e,i){return t[0]=Math.max(e[0],i[0]),t[1]=Math.max(e[1],i[1]),t},a.scale=function(t,e,i){return t[0]=e[0]*i,t[1]=e[1]*i,t},a.scaleAndAdd=function(t,e,i,n){return t[0]=e[0]+i[0]*n,t[1]=e[1]+i[1]*n,t},a.distance=function(t,e){var i=e[0]-t[0],n=e[1]-t[1];return Math.sqrt(i*i+n*n)},a.dist=a.distance,a.squaredDistance=function(t,e){var i=e[0]-t[0],n=e[1]-t[1];return i*i+n*n},a.sqrDist=a.squaredDistance,a.length=function(t){var e=t[0],i=t[1];return Math.sqrt(e*e+i*i)},a.len=a.length,a.squaredLength=function(t){var e=t[0],i=t[1];return e*e+i*i},a.sqrLen=a.squaredLength,a.negate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t},a.inverse=function(t,e){return t[0]=1/e[0],t[1]=1/e[1],t},a.normalize=function(t,e){var i=e[0],n=e[1],r=i*i+n*n;return r>0&&(r=1/Math.sqrt(r),t[0]=e[0]*r,t[1]=e[1]*r),t},a.dot=function(t,e){return t[0]*e[0]+t[1]*e[1]},a.cross=function(t,e,i){var n=e[0]*i[1]-e[1]*i[0];return t[0]=t[1]=0,t[2]=n,t},a.lerp=function(t,e,i,n){var r=e[0],s=e[1];return t[0]=r+n*(i[0]-r),t[1]=s+n*(i[1]-s),t},a.random=function(t,e){e=e||1;var i=2*n()*Math.PI;return t[0]=Math.cos(i)*e,t[1]=Math.sin(i)*e,t},a.transformMat2=function(t,e,i){var n=e[0],r=e[1];return t[0]=i[0]*n+i[2]*r,t[1]=i[1]*n+i[3]*r,t},a.transformMat2d=function(t,e,i){var n=e[0],r=e[1];return t[0]=i[0]*n+i[2]*r+i[4],t[1]=i[1]*n+i[3]*r+i[5],t},a.transformMat3=function(t,e,i){var n=e[0],r=e[1];return t[0]=i[0]*n+i[3]*r+i[6],t[1]=i[1]*n+i[4]*r+i[7],t},a.transformMat4=function(t,e,i){var n=e[0],r=e[1];return t[0]=i[0]*n+i[4]*r+i[12],t[1]=i[1]*n+i[5]*r+i[13],t},a.forEach=function(){var t=a.create();return function(e,i,n,r,s,a){var o,h;for(i||(i=2),n||(n=0),h=r?Math.min(r*i+n,e.length):e.length,o=n;o<h;o+=i)t[0]=e[o],t[1]=e[o+1],s(t,t,a),e[o]=t[0],e[o+1]=t[1];return e}}(),a.str=function(t){return"vec2("+t[0]+", "+t[1]+")"},void 0!==t&&(t.vec2=a);var o={create:function(){var t=new i(3);return t[0]=0,t[1]=0,t[2]=0,t},clone:function(t){var e=new i(3);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e},fromValues:function(t,e,n){var r=new i(3);return r[0]=t,r[1]=e,r[2]=n,r},copy:function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t},set:function(t,e,i,n){return t[0]=e,t[1]=i,t[2]=n,t},add:function(t,e,i){return t[0]=e[0]+i[0],t[1]=e[1]+i[1],t[2]=e[2]+i[2],t},subtract:function(t,e,i){return t[0]=e[0]-i[0],t[1]=e[1]-i[1],t[2]=e[2]-i[2],t}};o.sub=o.subtract,o.multiply=function(t,e,i){return t[0]=e[0]*i[0],t[1]=e[1]*i[1],t[2]=e[2]*i[2],t},o.mul=o.multiply,o.divide=function(t,e,i){return t[0]=e[0]/i[0],t[1]=e[1]/i[1],t[2]=e[2]/i[2],t},o.div=o.divide,o.min=function(t,e,i){return t[0]=Math.min(e[0],i[0]),t[1]=Math.min(e[1],i[1]),t[2]=Math.min(e[2],i[2]),t},o.max=function(t,e,i){return t[0]=Math.max(e[0],i[0]),t[1]=Math.max(e[1],i[1]),t[2]=Math.max(e[2],i[2]),t},o.scale=function(t,e,i){return t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i,t},o.scaleAndAdd=function(t,e,i,n){return t[0]=e[0]+i[0]*n,t[1]=e[1]+i[1]*n,t[2]=e[2]+i[2]*n,t},o.distance=function(t,e){var i=e[0]-t[0],n=e[1]-t[1],r=e[2]-t[2];return Math.sqrt(i*i+n*n+r*r)},o.dist=o.distance,o.squaredDistance=function(t,e){var i=e[0]-t[0],n=e[1]-t[1],r=e[2]-t[2];return i*i+n*n+r*r},o.sqrDist=o.squaredDistance,o.length=function(t){var e=t[0],i=t[1],n=t[2];return Math.sqrt(e*e+i*i+n*n)},o.len=o.length,o.squaredLength=function(t){var e=t[0],i=t[1],n=t[2];return e*e+i*i+n*n},o.sqrLen=o.squaredLength,o.negate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t},o.inverse=function(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t},o.normalize=function(t,e){var i=e[0],n=e[1],r=e[2],s=i*i+n*n+r*r;return s>0&&(s=1/Math.sqrt(s),t[0]=e[0]*s,t[1]=e[1]*s,t[2]=e[2]*s),t},o.dot=function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]},o.cross=function(t,e,i){var n=e[0],r=e[1],s=e[2],a=i[0],o=i[1],h=i[2];return t[0]=r*h-s*o,t[1]=s*a-n*h,t[2]=n*o-r*a,t},o.lerp=function(t,e,i,n){var r=e[0],s=e[1],a=e[2];return t[0]=r+n*(i[0]-r),t[1]=s+n*(i[1]-s),t[2]=a+n*(i[2]-a),t},o.random=function(t,e){e=e||1;var i=2*n()*Math.PI,r=2*n()-1,s=Math.sqrt(1-r*r)*e;return t[0]=Math.cos(i)*s,t[1]=Math.sin(i)*s,t[2]=r*e,t},o.transformMat4=function(t,e,i){var n=e[0],r=e[1],s=e[2],a=i[3]*n+i[7]*r+i[11]*s+i[15];return a=a||1,t[0]=(i[0]*n+i[4]*r+i[8]*s+i[12])/a,t[1]=(i[1]*n+i[5]*r+i[9]*s+i[13])/a,t[2]=(i[2]*n+i[6]*r+i[10]*s+i[14])/a,t},o.transformMat3=function(t,e,i){var n=e[0],r=e[1],s=e[2];return t[0]=n*i[0]+r*i[3]+s*i[6],t[1]=n*i[1]+r*i[4]+s*i[7],t[2]=n*i[2]+r*i[5]+s*i[8],t},o.transformQuat=function(t,e,i){var n=e[0],r=e[1],s=e[2],a=i[0],o=i[1],h=i[2],l=i[3],c=l*n+o*s-h*r,u=l*r+h*n-a*s,d=l*s+a*r-o*n,f=-a*n-o*r-h*s;return t[0]=c*l+f*-a+u*-h-d*-o,t[1]=u*l+f*-o+d*-a-c*-h,t[2]=d*l+f*-h+c*-o-u*-a,t},o.rotateX=function(t,e,i,n){var r=[],s=[];return r[0]=e[0]-i[0],r[1]=e[1]-i[1],r[2]=e[2]-i[2],s[0]=r[0],s[1]=r[1]*Math.cos(n)-r[2]*Math.sin(n),s[2]=r[1]*Math.sin(n)+r[2]*Math.cos(n),t[0]=s[0]+i[0],t[1]=s[1]+i[1],t[2]=s[2]+i[2],t},o.rotateY=function(t,e,i,n){var r=[],s=[];return r[0]=e[0]-i[0],r[1]=e[1]-i[1],r[2]=e[2]-i[2],s[0]=r[2]*Math.sin(n)+r[0]*Math.cos(n),s[1]=r[1],s[2]=r[2]*Math.cos(n)-r[0]*Math.sin(n),t[0]=s[0]+i[0],t[1]=s[1]+i[1],t[2]=s[2]+i[2],t},o.rotateZ=function(t,e,i,n){var r=[],s=[];return r[0]=e[0]-i[0],r[1]=e[1]-i[1],r[2]=e[2]-i[2],s[0]=r[0]*Math.cos(n)-r[1]*Math.sin(n),s[1]=r[0]*Math.sin(n)+r[1]*Math.cos(n),s[2]=r[2],t[0]=s[0]+i[0],t[1]=s[1]+i[1],t[2]=s[2]+i[2],t},o.forEach=function(){var t=o.create();return function(e,i,n,r,s,a){var o,h;for(i||(i=3),n||(n=0),h=r?Math.min(r*i+n,e.length):e.length,o=n;o<h;o+=i)t[0]=e[o],t[1]=e[o+1],t[2]=e[o+2],s(t,t,a),e[o]=t[0],e[o+1]=t[1],e[o+2]=t[2];return e}}(),o.angle=function(t,e){var i=o.fromValues(t[0],t[1],t[2]),n=o.fromValues(e[0],e[1],e[2]);o.normalize(i,i),o.normalize(n,n);var r=o.dot(i,n);return r>1?0:Math.acos(r)},o.str=function(t){return"vec3("+t[0]+", "+t[1]+", "+t[2]+")"},void 0!==t&&(t.vec3=o);var h={create:function(){var t=new i(4);return t[0]=0,t[1]=0,t[2]=0,t[3]=0,t},clone:function(t){var e=new i(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},fromValues:function(t,e,n,r){var s=new i(4);return s[0]=t,s[1]=e,s[2]=n,s[3]=r,s},copy:function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},set:function(t,e,i,n,r){return t[0]=e,t[1]=i,t[2]=n,t[3]=r,t},add:function(t,e,i){return t[0]=e[0]+i[0],t[1]=e[1]+i[1],t[2]=e[2]+i[2],t[3]=e[3]+i[3],t},subtract:function(t,e,i){return t[0]=e[0]-i[0],t[1]=e[1]-i[1],t[2]=e[2]-i[2],t[3]=e[3]-i[3],t}};h.sub=h.subtract,h.multiply=function(t,e,i){return t[0]=e[0]*i[0],t[1]=e[1]*i[1],t[2]=e[2]*i[2],t[3]=e[3]*i[3],t},h.mul=h.multiply,h.divide=function(t,e,i){return t[0]=e[0]/i[0],t[1]=e[1]/i[1],t[2]=e[2]/i[2],t[3]=e[3]/i[3],t},h.div=h.divide,h.min=function(t,e,i){return t[0]=Math.min(e[0],i[0]),t[1]=Math.min(e[1],i[1]),t[2]=Math.min(e[2],i[2]),t[3]=Math.min(e[3],i[3]),t},h.max=function(t,e,i){return t[0]=Math.max(e[0],i[0]),t[1]=Math.max(e[1],i[1]),t[2]=Math.max(e[2],i[2]),t[3]=Math.max(e[3],i[3]),t},h.scale=function(t,e,i){return t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i,t[3]=e[3]*i,t},h.scaleAndAdd=function(t,e,i,n){return t[0]=e[0]+i[0]*n,t[1]=e[1]+i[1]*n,t[2]=e[2]+i[2]*n,t[3]=e[3]+i[3]*n,t},h.distance=function(t,e){var i=e[0]-t[0],n=e[1]-t[1],r=e[2]-t[2],s=e[3]-t[3];return Math.sqrt(i*i+n*n+r*r+s*s)},h.dist=h.distance,h.squaredDistance=function(t,e){var i=e[0]-t[0],n=e[1]-t[1],r=e[2]-t[2],s=e[3]-t[3];return i*i+n*n+r*r+s*s},h.sqrDist=h.squaredDistance,h.length=function(t){var e=t[0],i=t[1],n=t[2],r=t[3];return Math.sqrt(e*e+i*i+n*n+r*r)},h.len=h.length,h.squaredLength=function(t){var e=t[0],i=t[1],n=t[2],r=t[3];return e*e+i*i+n*n+r*r},h.sqrLen=h.squaredLength,h.negate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=-e[3],t},h.inverse=function(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t[3]=1/e[3],t},h.normalize=function(t,e){var i=e[0],n=e[1],r=e[2],s=e[3],a=i*i+n*n+r*r+s*s;return a>0&&(a=1/Math.sqrt(a),t[0]=e[0]*a,t[1]=e[1]*a,t[2]=e[2]*a,t[3]=e[3]*a),t},h.dot=function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]},h.lerp=function(t,e,i,n){var r=e[0],s=e[1],a=e[2],o=e[3];return t[0]=r+n*(i[0]-r),t[1]=s+n*(i[1]-s),t[2]=a+n*(i[2]-a),t[3]=o+n*(i[3]-o),t},h.random=function(t,e){return e=e||1,t[0]=n(),t[1]=n(),t[2]=n(),t[3]=n(),h.normalize(t,t),h.scale(t,t,e),t},h.transformMat4=function(t,e,i){var n=e[0],r=e[1],s=e[2],a=e[3];return t[0]=i[0]*n+i[4]*r+i[8]*s+i[12]*a,t[1]=i[1]*n+i[5]*r+i[9]*s+i[13]*a,t[2]=i[2]*n+i[6]*r+i[10]*s+i[14]*a,t[3]=i[3]*n+i[7]*r+i[11]*s+i[15]*a,t},h.transformQuat=function(t,e,i){var n=e[0],r=e[1],s=e[2],a=i[0],o=i[1],h=i[2],l=i[3],c=l*n+o*s-h*r,u=l*r+h*n-a*s,d=l*s+a*r-o*n,f=-a*n-o*r-h*s;return t[0]=c*l+f*-a+u*-h-d*-o,t[1]=u*l+f*-o+d*-a-c*-h,t[2]=d*l+f*-h+c*-o-u*-a,t},h.forEach=function(){var t=h.create();return function(e,i,n,r,s,a){var o,h;for(i||(i=4),n||(n=0),h=r?Math.min(r*i+n,e.length):e.length,o=n;o<h;o+=i)t[0]=e[o],t[1]=e[o+1],t[2]=e[o+2],t[3]=e[o+3],s(t,t,a),e[o]=t[0],e[o+1]=t[1],e[o+2]=t[2],e[o+3]=t[3];return e}}(),h.str=function(t){return"vec4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},void 0!==t&&(t.vec4=h);var l={create:function(){var t=new i(4);return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t},clone:function(t){var e=new i(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},copy:function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},identity:function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t},transpose:function(t,e){if(t===e){var i=e[1];t[1]=e[2],t[2]=i}else t[0]=e[0],t[1]=e[2],t[2]=e[1],t[3]=e[3];return t},invert:function(t,e){var i=e[0],n=e[1],r=e[2],s=e[3],a=i*s-r*n;return a?(a=1/a,t[0]=s*a,t[1]=-n*a,t[2]=-r*a,t[3]=i*a,t):null},adjoint:function(t,e){var i=e[0];return t[0]=e[3],t[1]=-e[1],t[2]=-e[2],t[3]=i,t},determinant:function(t){return t[0]*t[3]-t[2]*t[1]},multiply:function(t,e,i){var n=e[0],r=e[1],s=e[2],a=e[3],o=i[0],h=i[1],l=i[2],c=i[3];return t[0]=n*o+s*h,t[1]=r*o+a*h,t[2]=n*l+s*c,t[3]=r*l+a*c,t}};l.mul=l.multiply,l.rotate=function(t,e,i){var n=e[0],r=e[1],s=e[2],a=e[3],o=Math.sin(i),h=Math.cos(i);return t[0]=n*h+s*o,t[1]=r*h+a*o,t[2]=n*-o+s*h,t[3]=r*-o+a*h,t},l.scale=function(t,e,i){var n=e[0],r=e[1],s=e[2],a=e[3],o=i[0],h=i[1];return t[0]=n*o,t[1]=r*o,t[2]=s*h,t[3]=a*h,t},l.str=function(t){return"mat2("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},l.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2))},l.LDU=function(t,e,i,n){return t[2]=n[2]/n[0],i[0]=n[0],i[1]=n[1],i[3]=n[3]-t[2]*i[1],[t,e,i]},void 0!==t&&(t.mat2=l);var c={create:function(){var t=new i(6);return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t},clone:function(t){var e=new i(6);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e},copy:function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t},identity:function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t},invert:function(t,e){var i=e[0],n=e[1],r=e[2],s=e[3],a=e[4],o=e[5],h=i*s-n*r;return h?(h=1/h,t[0]=s*h,t[1]=-n*h,t[2]=-r*h,t[3]=i*h,t[4]=(r*o-s*a)*h,t[5]=(n*a-i*o)*h,t):null},determinant:function(t){return t[0]*t[3]-t[1]*t[2]},multiply:function(t,e,i){var n=e[0],r=e[1],s=e[2],a=e[3],o=e[4],h=e[5],l=i[0],c=i[1],u=i[2],d=i[3],f=i[4],p=i[5];return t[0]=n*l+s*c,t[1]=r*l+a*c,t[2]=n*u+s*d,t[3]=r*u+a*d,t[4]=n*f+s*p+o,t[5]=r*f+a*p+h,t}};c.mul=c.multiply,c.rotate=function(t,e,i){var n=e[0],r=e[1],s=e[2],a=e[3],o=e[4],h=e[5],l=Math.sin(i),c=Math.cos(i);return t[0]=n*c+s*l,t[1]=r*c+a*l,t[2]=n*-l+s*c,t[3]=r*-l+a*c,t[4]=o,t[5]=h,t},c.scale=function(t,e,i){var n=e[0],r=e[1],s=e[2],a=e[3],o=e[4],h=e[5],l=i[0],c=i[1];return t[0]=n*l,t[1]=r*l,t[2]=s*c,t[3]=a*c,t[4]=o,t[5]=h,t},c.translate=function(t,e,i){var n=e[0],r=e[1],s=e[2],a=e[3],o=e[4],h=e[5],l=i[0],c=i[1];return t[0]=n,t[1]=r,t[2]=s,t[3]=a,t[4]=n*l+s*c+o,t[5]=r*l+a*c+h,t},c.str=function(t){return"mat2d("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+")"},c.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2)+Math.pow(t[4],2)+Math.pow(t[5],2)+1)},void 0!==t&&(t.mat2d=c);var u={create:function(){var t=new i(9);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},fromMat4:function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[4],t[4]=e[5],t[5]=e[6],t[6]=e[8],t[7]=e[9],t[8]=e[10],t},clone:function(t){var e=new i(9);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e},copy:function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t},identity:function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},transpose:function(t,e){if(t===e){var i=e[1],n=e[2],r=e[5];t[1]=e[3],t[2]=e[6],t[3]=i,t[5]=e[7],t[6]=n,t[7]=r}else t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8];return t},invert:function(t,e){var i=e[0],n=e[1],r=e[2],s=e[3],a=e[4],o=e[5],h=e[6],l=e[7],c=e[8],u=c*a-o*l,d=-c*s+o*h,f=l*s-a*h,p=i*u+n*d+r*f;return p?(p=1/p,t[0]=u*p,t[1]=(-c*n+r*l)*p,t[2]=(o*n-r*a)*p,t[3]=d*p,t[4]=(c*i-r*h)*p,t[5]=(-o*i+r*s)*p,t[6]=f*p,t[7]=(-l*i+n*h)*p,t[8]=(a*i-n*s)*p,t):null},adjoint:function(t,e){var i=e[0],n=e[1],r=e[2],s=e[3],a=e[4],o=e[5],h=e[6],l=e[7],c=e[8];return t[0]=a*c-o*l,t[1]=r*l-n*c,t[2]=n*o-r*a,t[3]=o*h-s*c,t[4]=i*c-r*h,t[5]=r*s-i*o,t[6]=s*l-a*h,t[7]=n*h-i*l,t[8]=i*a-n*s,t},determinant:function(t){var e=t[0],i=t[1],n=t[2],r=t[3],s=t[4],a=t[5],o=t[6],h=t[7],l=t[8];return e*(l*s-a*h)+i*(-l*r+a*o)+n*(h*r-s*o)},multiply:function(t,e,i){var n=e[0],r=e[1],s=e[2],a=e[3],o=e[4],h=e[5],l=e[6],c=e[7],u=e[8],d=i[0],f=i[1],p=i[2],v=i[3],m=i[4],w=i[5],g=i[6],b=i[7],L=i[8];return t[0]=d*n+f*a+p*l,t[1]=d*r+f*o+p*c,t[2]=d*s+f*h+p*u,t[3]=v*n+m*a+w*l,t[4]=v*r+m*o+w*c,t[5]=v*s+m*h+w*u,t[6]=g*n+b*a+L*l,t[7]=g*r+b*o+L*c,t[8]=g*s+b*h+L*u,t}};u.mul=u.multiply,u.translate=function(t,e,i){var n=e[0],r=e[1],s=e[2],a=e[3],o=e[4],h=e[5],l=e[6],c=e[7],u=e[8],d=i[0],f=i[1];return t[0]=n,t[1]=r,t[2]=s,t[3]=a,t[4]=o,t[5]=h,t[6]=d*n+f*a+l,t[7]=d*r+f*o+c,t[8]=d*s+f*h+u,t},u.rotate=function(t,e,i){var n=e[0],r=e[1],s=e[2],a=e[3],o=e[4],h=e[5],l=e[6],c=e[7],u=e[8],d=Math.sin(i),f=Math.cos(i);return t[0]=f*n+d*a,t[1]=f*r+d*o,t[2]=f*s+d*h,t[3]=f*a-d*n,t[4]=f*o-d*r,t[5]=f*h-d*s,t[6]=l,t[7]=c,t[8]=u,t},u.scale=function(t,e,i){var n=i[0],r=i[1];return t[0]=n*e[0],t[1]=n*e[1],t[2]=n*e[2],t[3]=r*e[3],t[4]=r*e[4],t[5]=r*e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t},u.fromMat2d=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=0,t[3]=e[2],t[4]=e[3],t[5]=0,t[6]=e[4],t[7]=e[5],t[8]=1,t},u.fromQuat=function(t,e){var i=e[0],n=e[1],r=e[2],s=e[3],a=i+i,o=n+n,h=r+r,l=i*a,c=n*a,u=n*o,d=r*a,f=r*o,p=r*h,v=s*a,m=s*o,w=s*h;return t[0]=1-u-p,t[3]=c-w,t[6]=d+m,t[1]=c+w,t[4]=1-l-p,t[7]=f-v,t[2]=d-m,t[5]=f+v,t[8]=1-l-u,t},u.normalFromMat4=function(t,e){var i=e[0],n=e[1],r=e[2],s=e[3],a=e[4],o=e[5],h=e[6],l=e[7],c=e[8],u=e[9],d=e[10],f=e[11],p=e[12],v=e[13],m=e[14],w=e[15],g=i*o-n*a,b=i*h-r*a,L=i*l-s*a,y=n*h-r*o,S=n*l-s*o,E=r*l-s*h,M=c*v-u*p,D=c*m-d*p,T=c*w-f*p,G=u*m-d*v,x=u*w-f*v,_=d*w-f*m,C=g*_-b*x+L*G+y*T-S*D+E*M;return C?(C=1/C,t[0]=(o*_-h*x+l*G)*C,t[1]=(h*T-a*_-l*D)*C,t[2]=(a*x-o*T+l*M)*C,t[3]=(r*x-n*_-s*G)*C,t[4]=(i*_-r*T+s*D)*C,t[5]=(n*T-i*x-s*M)*C,t[6]=(v*E-m*S+w*y)*C,t[7]=(m*L-p*E-w*b)*C,t[8]=(p*S-v*L+w*g)*C,t):null},u.str=function(t){return"mat3("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+")"},u.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2)+Math.pow(t[4],2)+Math.pow(t[5],2)+Math.pow(t[6],2)+Math.pow(t[7],2)+Math.pow(t[8],2))},void 0!==t&&(t.mat3=u);var d={create:function(){var t=new i(16);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},clone:function(t){var e=new i(16);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},copy:function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},identity:function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},transpose:function(t,e){if(t===e){var i=e[1],n=e[2],r=e[3],s=e[6],a=e[7],o=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=i,t[6]=e[9],t[7]=e[13],t[8]=n,t[9]=s,t[11]=e[14],t[12]=r,t[13]=a,t[14]=o}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t},invert:function(t,e){var i=e[0],n=e[1],r=e[2],s=e[3],a=e[4],o=e[5],h=e[6],l=e[7],c=e[8],u=e[9],d=e[10],f=e[11],p=e[12],v=e[13],m=e[14],w=e[15],g=i*o-n*a,b=i*h-r*a,L=i*l-s*a,y=n*h-r*o,S=n*l-s*o,E=r*l-s*h,M=c*v-u*p,D=c*m-d*p,T=c*w-f*p,G=u*m-d*v,x=u*w-f*v,_=d*w-f*m,C=g*_-b*x+L*G+y*T-S*D+E*M;return C?(C=1/C,t[0]=(o*_-h*x+l*G)*C,t[1]=(r*x-n*_-s*G)*C,t[2]=(v*E-m*S+w*y)*C,t[3]=(d*S-u*E-f*y)*C,t[4]=(h*T-a*_-l*D)*C,t[5]=(i*_-r*T+s*D)*C,t[6]=(m*L-p*E-w*b)*C,t[7]=(c*E-d*L+f*b)*C,t[8]=(a*x-o*T+l*M)*C,t[9]=(n*T-i*x-s*M)*C,t[10]=(p*S-v*L+w*g)*C,t[11]=(u*L-c*S-f*g)*C,t[12]=(o*D-a*G-h*M)*C,t[13]=(i*G-n*D+r*M)*C,t[14]=(v*b-p*y-m*g)*C,t[15]=(c*y-u*b+d*g)*C,t):null},adjoint:function(t,e){var i=e[0],n=e[1],r=e[2],s=e[3],a=e[4],o=e[5],h=e[6],l=e[7],c=e[8],u=e[9],d=e[10],f=e[11],p=e[12],v=e[13],m=e[14],w=e[15];return t[0]=o*(d*w-f*m)-u*(h*w-l*m)+v*(h*f-l*d),t[1]=-(n*(d*w-f*m)-u*(r*w-s*m)+v*(r*f-s*d)),t[2]=n*(h*w-l*m)-o*(r*w-s*m)+v*(r*l-s*h),t[3]=-(n*(h*f-l*d)-o*(r*f-s*d)+u*(r*l-s*h)),t[4]=-(a*(d*w-f*m)-c*(h*w-l*m)+p*(h*f-l*d)),t[5]=i*(d*w-f*m)-c*(r*w-s*m)+p*(r*f-s*d),t[6]=-(i*(h*w-l*m)-a*(r*w-s*m)+p*(r*l-s*h)),t[7]=i*(h*f-l*d)-a*(r*f-s*d)+c*(r*l-s*h),t[8]=a*(u*w-f*v)-c*(o*w-l*v)+p*(o*f-l*u),t[9]=-(i*(u*w-f*v)-c*(n*w-s*v)+p*(n*f-s*u)),t[10]=i*(o*w-l*v)-a*(n*w-s*v)+p*(n*l-s*o),t[11]=-(i*(o*f-l*u)-a*(n*f-s*u)+c*(n*l-s*o)),t[12]=-(a*(u*m-d*v)-c*(o*m-h*v)+p*(o*d-h*u)),t[13]=i*(u*m-d*v)-c*(n*m-r*v)+p*(n*d-r*u),t[14]=-(i*(o*m-h*v)-a*(n*m-r*v)+p*(n*h-r*o)),t[15]=i*(o*d-h*u)-a*(n*d-r*u)+c*(n*h-r*o),t},determinant:function(t){var e=t[0],i=t[1],n=t[2],r=t[3],s=t[4],a=t[5],o=t[6],h=t[7],l=t[8],c=t[9],u=t[10],d=t[11],f=t[12],p=t[13],v=t[14],m=t[15];return(e*a-i*s)*(u*m-d*v)-(e*o-n*s)*(c*m-d*p)+(e*h-r*s)*(c*v-u*p)+(i*o-n*a)*(l*m-d*f)-(i*h-r*a)*(l*v-u*f)+(n*h-r*o)*(l*p-c*f)},multiply:function(t,e,i){var n=e[0],r=e[1],s=e[2],a=e[3],o=e[4],h=e[5],l=e[6],c=e[7],u=e[8],d=e[9],f=e[10],p=e[11],v=e[12],m=e[13],w=e[14],g=e[15],b=i[0],L=i[1],y=i[2],S=i[3];return t[0]=b*n+L*o+y*u+S*v,t[1]=b*r+L*h+y*d+S*m,t[2]=b*s+L*l+y*f+S*w,t[3]=b*a+L*c+y*p+S*g,b=i[4],L=i[5],y=i[6],S=i[7],t[4]=b*n+L*o+y*u+S*v,t[5]=b*r+L*h+y*d+S*m,t[6]=b*s+L*l+y*f+S*w,t[7]=b*a+L*c+y*p+S*g,b=i[8],L=i[9],y=i[10],S=i[11],t[8]=b*n+L*o+y*u+S*v,t[9]=b*r+L*h+y*d+S*m,t[10]=b*s+L*l+y*f+S*w,t[11]=b*a+L*c+y*p+S*g,b=i[12],L=i[13],y=i[14],S=i[15],t[12]=b*n+L*o+y*u+S*v,t[13]=b*r+L*h+y*d+S*m,t[14]=b*s+L*l+y*f+S*w,t[15]=b*a+L*c+y*p+S*g,t}};d.mul=d.multiply,d.translate=function(t,e,i){var n,r,s,a,o,h,l,c,u,d,f,p,v=i[0],m=i[1],w=i[2];return e===t?(t[12]=e[0]*v+e[4]*m+e[8]*w+e[12],t[13]=e[1]*v+e[5]*m+e[9]*w+e[13],t[14]=e[2]*v+e[6]*m+e[10]*w+e[14],t[15]=e[3]*v+e[7]*m+e[11]*w+e[15]):(n=e[0],r=e[1],s=e[2],a=e[3],o=e[4],h=e[5],l=e[6],c=e[7],u=e[8],d=e[9],f=e[10],p=e[11],t[0]=n,t[1]=r,t[2]=s,t[3]=a,t[4]=o,t[5]=h,t[6]=l,t[7]=c,t[8]=u,t[9]=d,t[10]=f,t[11]=p,t[12]=n*v+o*m+u*w+e[12],t[13]=r*v+h*m+d*w+e[13],t[14]=s*v+l*m+f*w+e[14],t[15]=a*v+c*m+p*w+e[15]),t},d.scale=function(t,e,i){var n=i[0],r=i[1],s=i[2];return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*r,t[5]=e[5]*r,t[6]=e[6]*r,t[7]=e[7]*r,t[8]=e[8]*s,t[9]=e[9]*s,t[10]=e[10]*s,t[11]=e[11]*s,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},d.rotate=function(t,i,n,r){var s,a,o,h,l,c,u,d,f,p,v,m,w,g,b,L,y,S,E,M,D,T,G,x,_=r[0],C=r[1],B=r[2],P=Math.sqrt(_*_+C*C+B*B);return Math.abs(P)<e?null:(_*=P=1/P,C*=P,B*=P,s=Math.sin(n),o=1-(a=Math.cos(n)),h=i[0],l=i[1],c=i[2],u=i[3],d=i[4],f=i[5],p=i[6],v=i[7],m=i[8],w=i[9],g=i[10],b=i[11],L=_*_*o+a,y=C*_*o+B*s,S=B*_*o-C*s,E=_*C*o-B*s,M=C*C*o+a,D=B*C*o+_*s,T=_*B*o+C*s,G=C*B*o-_*s,x=B*B*o+a,t[0]=h*L+d*y+m*S,t[1]=l*L+f*y+w*S,t[2]=c*L+p*y+g*S,t[3]=u*L+v*y+b*S,t[4]=h*E+d*M+m*D,t[5]=l*E+f*M+w*D,t[6]=c*E+p*M+g*D,t[7]=u*E+v*M+b*D,t[8]=h*T+d*G+m*x,t[9]=l*T+f*G+w*x,t[10]=c*T+p*G+g*x,t[11]=u*T+v*G+b*x,i!==t&&(t[12]=i[12],t[13]=i[13],t[14]=i[14],t[15]=i[15]),t)},d.rotateX=function(t,e,i){var n=Math.sin(i),r=Math.cos(i),s=e[4],a=e[5],o=e[6],h=e[7],l=e[8],c=e[9],u=e[10],d=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=s*r+l*n,t[5]=a*r+c*n,t[6]=o*r+u*n,t[7]=h*r+d*n,t[8]=l*r-s*n,t[9]=c*r-a*n,t[10]=u*r-o*n,t[11]=d*r-h*n,t},d.rotateY=function(t,e,i){var n=Math.sin(i),r=Math.cos(i),s=e[0],a=e[1],o=e[2],h=e[3],l=e[8],c=e[9],u=e[10],d=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=s*r-l*n,t[1]=a*r-c*n,t[2]=o*r-u*n,t[3]=h*r-d*n,t[8]=s*n+l*r,t[9]=a*n+c*r,t[10]=o*n+u*r,t[11]=h*n+d*r,t},d.rotateZ=function(t,e,i){var n=Math.sin(i),r=Math.cos(i),s=e[0],a=e[1],o=e[2],h=e[3],l=e[4],c=e[5],u=e[6],d=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=s*r+l*n,t[1]=a*r+c*n,t[2]=o*r+u*n,t[3]=h*r+d*n,t[4]=l*r-s*n,t[5]=c*r-a*n,t[6]=u*r-o*n,t[7]=d*r-h*n,t},d.fromRotationTranslation=function(t,e,i){var n=e[0],r=e[1],s=e[2],a=e[3],o=n+n,h=r+r,l=s+s,c=n*o,u=n*h,d=n*l,f=r*h,p=r*l,v=s*l,m=a*o,w=a*h,g=a*l;return t[0]=1-(f+v),t[1]=u+g,t[2]=d-w,t[3]=0,t[4]=u-g,t[5]=1-(c+v),t[6]=p+m,t[7]=0,t[8]=d+w,t[9]=p-m,t[10]=1-(c+f),t[11]=0,t[12]=i[0],t[13]=i[1],t[14]=i[2],t[15]=1,t},d.fromQuat=function(t,e){var i=e[0],n=e[1],r=e[2],s=e[3],a=i+i,o=n+n,h=r+r,l=i*a,c=n*a,u=n*o,d=r*a,f=r*o,p=r*h,v=s*a,m=s*o,w=s*h;return t[0]=1-u-p,t[1]=c+w,t[2]=d-m,t[3]=0,t[4]=c-w,t[5]=1-l-p,t[6]=f+v,t[7]=0,t[8]=d+m,t[9]=f-v,t[10]=1-l-u,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},d.frustum=function(t,e,i,n,r,s,a){var o=1/(i-e),h=1/(r-n),l=1/(s-a);return t[0]=2*s*o,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=2*s*h,t[6]=0,t[7]=0,t[8]=(i+e)*o,t[9]=(r+n)*h,t[10]=(a+s)*l,t[11]=-1,t[12]=0,t[13]=0,t[14]=a*s*2*l,t[15]=0,t},d.perspective=function(t,e,i,n,r){var s=1/Math.tan(e/2),a=1/(n-r);return t[0]=s/i,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=s,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=(r+n)*a,t[11]=-1,t[12]=0,t[13]=0,t[14]=2*r*n*a,t[15]=0,t},d.ortho=function(t,e,i,n,r,s,a){var o=1/(e-i),h=1/(n-r),l=1/(s-a);return t[0]=-2*o,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*h,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*l,t[11]=0,t[12]=(e+i)*o,t[13]=(r+n)*h,t[14]=(a+s)*l,t[15]=1,t},d.lookAt=function(t,i,n,r){var s,a,o,h,l,c,u,f,p,v,m=i[0],w=i[1],g=i[2],b=r[0],L=r[1],y=r[2],S=n[0],E=n[1],M=n[2];return Math.abs(m-S)<e&&Math.abs(w-E)<e&&Math.abs(g-M)<e?d.identity(t):(u=m-S,f=w-E,p=g-M,s=L*(p*=v=1/Math.sqrt(u*u+f*f+p*p))-y*(f*=v),a=y*(u*=v)-b*p,o=b*f-L*u,(v=Math.sqrt(s*s+a*a+o*o))?(s*=v=1/v,a*=v,o*=v):(s=0,a=0,o=0),h=f*o-p*a,l=p*s-u*o,c=u*a-f*s,(v=Math.sqrt(h*h+l*l+c*c))?(h*=v=1/v,l*=v,c*=v):(h=0,l=0,c=0),t[0]=s,t[1]=h,t[2]=u,t[3]=0,t[4]=a,t[5]=l,t[6]=f,t[7]=0,t[8]=o,t[9]=c,t[10]=p,t[11]=0,t[12]=-(s*m+a*w+o*g),t[13]=-(h*m+l*w+c*g),t[14]=-(u*m+f*w+p*g),t[15]=1,t)},d.str=function(t){return"mat4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+", "+t[9]+", "+t[10]+", "+t[11]+", "+t[12]+", "+t[13]+", "+t[14]+", "+t[15]+")"},d.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2)+Math.pow(t[4],2)+Math.pow(t[5],2)+Math.pow(t[6],2)+Math.pow(t[7],2)+Math.pow(t[8],2)+Math.pow(t[9],2)+Math.pow(t[10],2)+Math.pow(t[11],2)+Math.pow(t[12],2)+Math.pow(t[13],2)+Math.pow(t[14],2)+Math.pow(t[15],2))},void 0!==t&&(t.mat4=d);var f={create:function(){var t=new i(4);return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t}};f.rotationTo=function(){var t=o.create(),e=o.fromValues(1,0,0),i=o.fromValues(0,1,0);return function(n,r,s){var a=o.dot(r,s);return a<-.999999?(o.cross(t,e,r),o.length(t)<1e-6&&o.cross(t,i,r),o.normalize(t,t),f.setAxisAngle(n,t,Math.PI),n):a>.999999?(n[0]=0,n[1]=0,n[2]=0,n[3]=1,n):(o.cross(t,r,s),n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=1+a,f.normalize(n,n))}}(),f.setAxes=function(){var t=u.create();return function(e,i,n,r){return t[0]=n[0],t[3]=n[1],t[6]=n[2],t[1]=r[0],t[4]=r[1],t[7]=r[2],t[2]=-i[0],t[5]=-i[1],t[8]=-i[2],f.normalize(e,f.fromMat3(e,t))}}(),f.clone=h.clone,f.fromValues=h.fromValues,f.copy=h.copy,f.set=h.set,f.identity=function(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t},f.setAxisAngle=function(t,e,i){i*=.5;var n=Math.sin(i);return t[0]=n*e[0],t[1]=n*e[1],t[2]=n*e[2],t[3]=Math.cos(i),t},f.add=h.add,f.multiply=function(t,e,i){var n=e[0],r=e[1],s=e[2],a=e[3],o=i[0],h=i[1],l=i[2],c=i[3];return t[0]=n*c+a*o+r*l-s*h,t[1]=r*c+a*h+s*o-n*l,t[2]=s*c+a*l+n*h-r*o,t[3]=a*c-n*o-r*h-s*l,t},f.mul=f.multiply,f.scale=h.scale,f.rotateX=function(t,e,i){i*=.5;var n=e[0],r=e[1],s=e[2],a=e[3],o=Math.sin(i),h=Math.cos(i);return t[0]=n*h+a*o,t[1]=r*h+s*o,t[2]=s*h-r*o,t[3]=a*h-n*o,t},f.rotateY=function(t,e,i){i*=.5;var n=e[0],r=e[1],s=e[2],a=e[3],o=Math.sin(i),h=Math.cos(i);return t[0]=n*h-s*o,t[1]=r*h+a*o,t[2]=s*h+n*o,t[3]=a*h-r*o,t},f.rotateZ=function(t,e,i){i*=.5;var n=e[0],r=e[1],s=e[2],a=e[3],o=Math.sin(i),h=Math.cos(i);return t[0]=n*h+r*o,t[1]=r*h-n*o,t[2]=s*h+a*o,t[3]=a*h-s*o,t},f.calculateW=function(t,e){var i=e[0],n=e[1],r=e[2];return t[0]=i,t[1]=n,t[2]=r,t[3]=Math.sqrt(Math.abs(1-i*i-n*n-r*r)),t},f.dot=h.dot,f.lerp=h.lerp,f.slerp=function(t,e,i,n){var r,s,a,o,h,l=e[0],c=e[1],u=e[2],d=e[3],f=i[0],p=i[1],v=i[2],m=i[3];return(s=l*f+c*p+u*v+d*m)<0&&(s=-s,f=-f,p=-p,v=-v,m=-m),1-s>1e-6?(r=Math.acos(s),a=Math.sin(r),o=Math.sin((1-n)*r)/a,h=Math.sin(n*r)/a):(o=1-n,h=n),t[0]=o*l+h*f,t[1]=o*c+h*p,t[2]=o*u+h*v,t[3]=o*d+h*m,t},f.invert=function(t,e){var i=e[0],n=e[1],r=e[2],s=e[3],a=i*i+n*n+r*r+s*s,o=a?1/a:0;return t[0]=-i*o,t[1]=-n*o,t[2]=-r*o,t[3]=s*o,t},f.conjugate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t},f.length=h.length,f.len=f.length,f.squaredLength=h.squaredLength,f.sqrLen=f.squaredLength,f.normalize=h.normalize,f.fromMat3=function(t,e){var i,n=e[0]+e[4]+e[8];if(n>0)i=Math.sqrt(n+1),t[3]=.5*i,i=.5/i,t[0]=(e[5]-e[7])*i,t[1]=(e[6]-e[2])*i,t[2]=(e[1]-e[3])*i;else{var r=0;e[4]>e[0]&&(r=1),e[8]>e[3*r+r]&&(r=2);var s=(r+1)%3,a=(r+2)%3;i=Math.sqrt(e[3*r+r]-e[3*s+s]-e[3*a+a]+1),t[r]=.5*i,i=.5/i,t[3]=(e[3*s+a]-e[3*a+s])*i,t[s]=(e[3*s+r]+e[3*r+s])*i,t[a]=(e[3*a+r]+e[3*r+a])*i}return t},f.str=function(t){return"quat("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},void 0!==t&&(t.quat=f)}(i.exports)}(this),function(){if("performance"in window==!1&&(window.performance={}),Date.now=Date.now||function(){return(new Date).getTime()},"now"in window.performance==!1){var t=window.performance.timing&&window.performance.timing.navigationStart?window.performance.timing.navigationStart:Date.now();window.performance.now=function(){return Date.now()-t}}}();var r=r||function(){var t=[];return{getAll:function(){return t},removeAll:function(){t=[]},add:function(e){t.push(e)},remove:function(e){var i=t.indexOf(e);-1!==i&&t.splice(i,1)},update:function(e){if(0===t.length)return!1;var i=0;for(e=void 0!==e?e:window.performance.now();i<t.length;)t[i].update(e)?i++:t.splice(i,1);return!0}}}();r.Tween=function(t){var e=t,i={},n={},s={},a=1e3,o=0,h=!1,l=!1,c=!1,u=0,d=null,f=r.Easing.Linear.None,p=r.Interpolation.Linear,v=[],m=null,w=!1,g=null,b=null,L=null;for(var y in t)i[y]=parseFloat(t[y],10);this.to=function(t,e){return void 0!==e&&(a=e),n=t,this},this.start=function(t){for(var a in r.add(this),l=!0,w=!1,d=void 0!==t?t:window.performance.now(),d+=u,n){if(n[a]instanceof Array){if(0===n[a].length)continue;n[a]=[e[a]].concat(n[a])}i[a]=e[a],i[a]instanceof Array==!1&&(i[a]*=1),s[a]=i[a]||0}return this},this.stop=function(){return l?(r.remove(this),l=!1,null!==L&&L.call(e),this.stopChainedTweens(),this):this},this.stopChainedTweens=function(){for(var t=0,e=v.length;t<e;t++)v[t].stop()},this.delay=function(t){return u=t,this},this.repeat=function(t){return o=t,this},this.yoyo=function(t){return h=t,this},this.easing=function(t){return f=t,this},this.interpolation=function(t){return p=t,this},this.chain=function(){return v=arguments,this},this.onStart=function(t){return m=t,this},this.onUpdate=function(t){return g=t,this},this.onComplete=function(t){return b=t,this},this.onStop=function(t){return L=t,this},this.update=function(t){var r,l,L;if(t<d)return!0;for(r in!1===w&&(null!==m&&m.call(e),w=!0),L=f(l=(l=(t-d)/a)>1?1:l),n){var y=i[r]||0,S=n[r];S instanceof Array?e[r]=p(S,L):("string"==typeof S&&(S=y+parseFloat(S,10)),"number"==typeof S&&(e[r]=y+(S-y)*L))}if(null!==g&&g.call(e,L),1===l){if(o>0){for(r in isFinite(o)&&o--,s){if("string"==typeof n[r]&&(s[r]=s[r]+parseFloat(n[r],10)),h){var E=s[r];s[r]=n[r],n[r]=E}i[r]=s[r]}return h&&(c=!c),d=t+u,!0}null!==b&&b.call(e);for(var M=0,D=v.length;M<D;M++)v[M].start(d+a);return!1}return!0}},r.Easing={Linear:{None:function(t){return t}},Quadratic:{In:function(t){return t*t},Out:function(t){return t*(2-t)},InOut:function(t){return(t*=2)<1?.5*t*t:-.5*(--t*(t-2)-1)}},Cubic:{In:function(t){return t*t*t},Out:function(t){return--t*t*t+1},InOut:function(t){return(t*=2)<1?.5*t*t*t:.5*((t-=2)*t*t+2)}},Quartic:{In:function(t){return t*t*t*t},Out:function(t){return 1- --t*t*t*t},InOut:function(t){return(t*=2)<1?.5*t*t*t*t:-.5*((t-=2)*t*t*t-2)}},Quintic:{In:function(t){return t*t*t*t*t},Out:function(t){return--t*t*t*t*t+1},InOut:function(t){return(t*=2)<1?.5*t*t*t*t*t:.5*((t-=2)*t*t*t*t+2)}},Sinusoidal:{In:function(t){return 1-Math.cos(t*Math.PI/2)},Out:function(t){return Math.sin(t*Math.PI/2)},InOut:function(t){return.5*(1-Math.cos(Math.PI*t))}},Exponential:{In:function(t){return 0===t?0:Math.pow(1024,t-1)},Out:function(t){return 1===t?1:1-Math.pow(2,-10*t)},InOut:function(t){return 0===t?0:1===t?1:(t*=2)<1?.5*Math.pow(1024,t-1):.5*(2-Math.pow(2,-10*(t-1)))}},Circular:{In:function(t){return 1-Math.sqrt(1-t*t)},Out:function(t){return Math.sqrt(1- --t*t)},InOut:function(t){return(t*=2)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1)}},Elastic:{In:function(t){var e,i=.1;return 0===t?0:1===t?1:(!i||i<1?(i=1,e=.1):e=.4*Math.asin(1/i)/(2*Math.PI),-i*Math.pow(2,10*(t-=1))*Math.sin((t-e)*(2*Math.PI)/.4))},Out:function(t){var e,i=.1;return 0===t?0:1===t?1:(!i||i<1?(i=1,e=.1):e=.4*Math.asin(1/i)/(2*Math.PI),i*Math.pow(2,-10*t)*Math.sin((t-e)*(2*Math.PI)/.4)+1)},InOut:function(t){var e,i=.1;return 0===t?0:1===t?1:(!i||i<1?(i=1,e=.1):e=.4*Math.asin(1/i)/(2*Math.PI),(t*=2)<1?i*Math.pow(2,10*(t-=1))*Math.sin((t-e)*(2*Math.PI)/.4)*-.5:i*Math.pow(2,-10*(t-=1))*Math.sin((t-e)*(2*Math.PI)/.4)*.5+1)}},Back:{In:function(t){var e=1.70158;return t*t*((e+1)*t-e)},Out:function(t){var e=1.70158;return--t*t*((e+1)*t+e)+1},InOut:function(t){var e=2.5949095;return(t*=2)<1?t*t*((e+1)*t-e)*.5:.5*((t-=2)*t*((e+1)*t+e)+2)}},Bounce:{In:function(t){return 1-r.Easing.Bounce.Out(1-t)},Out:function(t){return t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375},InOut:function(t){return t<.5?.5*r.Easing.Bounce.In(2*t):.5*r.Easing.Bounce.Out(2*t-1)+.5}}},r.Interpolation={Linear:function(t,e){var i=t.length-1,n=i*e,s=Math.floor(n),a=r.Interpolation.Utils.Linear;return e<0?a(t[0],t[1],n):e>1?a(t[i],t[i-1],i-n):a(t[s],t[s+1>i?i:s+1],n-s)},Bezier:function(t,e){for(var i=0,n=t.length-1,s=Math.pow,a=r.Interpolation.Utils.Bernstein,o=0;o<=n;o++)i+=s(1-e,n-o)*s(e,o)*t[o]*a(n,o);return i},CatmullRom:function(t,e){var i=t.length-1,n=i*e,s=Math.floor(n),a=r.Interpolation.Utils.CatmullRom;return t[0]===t[i]?(e<0&&(s=Math.floor(n=i*(1+e))),a(t[(s-1+i)%i],t[s],t[(s+1)%i],t[(s+2)%i],n-s)):e<0?t[0]-(a(t[0],t[0],t[1],t[1],-n)-t[0]):e>1?t[i]-(a(t[i],t[i],t[i-1],t[i-1],n-i)-t[i]):a(t[s?s-1:0],t[s],t[i<s+1?i:s+1],t[i<s+2?i:s+2],n-s)},Utils:{Linear:function(t,e,i){return(e-t)*i+t},Bernstein:function(t,e){var i=r.Interpolation.Utils.Factorial;return i(t)/i(e)/i(t-e)},Factorial:function(){var t=[1];return function(e){var i=1;if(t[e])return t[e];for(var n=e;n>1;n--)i*=n;return t[e]=i,i}}(),CatmullRom:function(t,e,i,n,r){var s=.5*(i-t),a=.5*(n-e),o=r*r;return(2*e-2*i+s+a)*(r*o)+(-3*e+3*i-2*s-a)*o+s*r+e}}},void 0===(n=function(){return r}.apply(e,[]))||(t.exports=n),function(){}.bind||(Function.prototype.bind=function(t){var e=this,i=Array.prototype.slice.call(arguments);return function(){return e.apply(t,i.slice(1))}}),Array.prototype.indexObj=function(t){for(var e=0;e<this.length;e++)if(this[e]===t)return e;return-1},function(){for(var t=0,e=["ms","moz","webkit","o"],i=0;i<e.length&&!window.requestAnimationFrame;++i)window.requestAnimationFrame=window[e[i]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[e[i]+"CancelAnimationFrame"]||window[e[i]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(e,i){var n=(new Date).getTime(),r=Math.max(0,16-(n-t)),s=window.setTimeout(function(){e(n+r)},r);return t=n+r,s}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(t){clearTimeout(t)})}(),function(){var t=document.attachEvent,e=!1;if(!t){var i=function(){var t=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||function(t){return window.setTimeout(t,20)};return function(e){return t(e)}}(),n=function(){var t=window.cancelAnimationFrame||window.mozCancelAnimationFrame||window.webkitCancelAnimationFrame||window.clearTimeout;return function(e){return t(e)}}(),r=function(t){var e=t.__resizeTriggers__,i=e.firstElementChild,n=e.lastElementChild,r=i.firstElementChild;n.scrollLeft=n.scrollWidth,n.scrollTop=n.scrollHeight,r.style.width=i.offsetWidth+1+"px",r.style.height=i.offsetHeight+1+"px",i.scrollLeft=i.scrollWidth,i.scrollTop=i.scrollHeight},s=function(t){var e=this;r(this),this.__resizeRAF__&&n(this.__resizeRAF__),this.__resizeRAF__=i(function(){(function(t){return t.offsetWidth!=t.__resizeLast__.width||t.offsetHeight!=t.__resizeLast__.height})(e)&&(e.__resizeLast__.width=e.offsetWidth,e.__resizeLast__.height=e.offsetHeight,e.__resizeListeners__.forEach(function(i){i.call(e,t)}))})},a=!1,o="",h="animationstart",l="Webkit Moz O ms".split(" "),c="webkitAnimationStart animationstart oAnimationStart MSAnimationStart".split(" "),u="",d=document.createElement("fakeelement");if(void 0!==d.style.animationName&&(a=!0),!1===a)for(var f=0;f<l.length;f++)if(void 0!==d.style[l[f]+"AnimationName"]){(u=l[f])+"Animation",o="-"+u.toLowerCase()+"-",h=c[f],a=!0;break}var p="resizeanim",v="@"+o+"keyframes "+p+" { from { opacity: 0; } to { opacity: 0; } } ",m=o+"animation: 1ms "+p+"; "}window.addResizeListener=function(i,n){t?i.attachEvent("onresize",n):(i.__resizeTriggers__||("static"==getComputedStyle(i).position&&(i.style.position="relative"),function(){if(!e){var t=(v||"")+".resize-triggers { "+(m||"")+"visibility: hidden; opacity: 0; } .resize-triggers, .resize-triggers > div, .contract-trigger:before { content: ' '; display: block; position: absolute; top: 0; left: 0; height: 100%; width: 100%; overflow: hidden; } .resize-triggers > div { background: #eee; overflow: auto; } .contract-trigger:before { width: 200%; height: 200%; }",i=document.head||document.getElementsByTagName("head")[0],n=document.createElement("style");n.type="text/css",n.styleSheet?n.styleSheet.cssText=t:n.appendChild(document.createTextNode(t)),i.appendChild(n),e=!0}}(),i.__resizeLast__={},i.__resizeListeners__=[],(i.__resizeTriggers__=document.createElement("div")).className="resize-triggers",i.__resizeTriggers__.innerHTML="<div class='expand-trigger'><div></div></div><div class='contract-trigger'></div>",i.appendChild(i.__resizeTriggers__),r(i),i.addEventListener("scroll",s,!0),h&&i.__resizeTriggers__.addEventListener(h,function(t){t.animationName==p&&r(i)})),i.__resizeListeners__.push(n))},window.removeResizeListener=function(e,i){t?e.detachEvent("onresize",i):(e.__resizeListeners__.splice(e.__resizeListeners__.indexOf(i),1),e.__resizeListeners__.length||(e.removeEventListener("scroll",s),e.__resizeTriggers__=!e.removeChild(e.__resizeTriggers__)))}}(),function(){var t,e,i={tip0:{en:"Loading ",cn:"%E5%8A%A0%E8%BD%BD%E4%B8%AD...",jp:"%E8%AA%AD%E3%81%BF%E8%BE%BC%E3%81%BF%E4%B8%AD%E2%80%A6"},tip11:"%E8%B5%84%E6%BA%90%E5%8A%A0%E8%BD%BD%E9%94%99%E8%AF%AF!",tip16:{en:"Normal View",cn:"%E6%AD%A3%E5%B8%B8%E8%A7%86%E8%A7%92",jp:"%E3%83%8E%E3%83%BC%E3%83%9E%E3%83%AB%E3%83%93%E3%83%A5%E3%83%BC"},tip17:{en:"Little Planet View",cn:"%E5%B0%8F%E8%A1%8C%E6%98%9F%E8%A7%86%E8%A7%92",jp:"%E6%83%91%E6%98%9F%E3%83%91%E3%83%8E%E3%83%A9%E3%83%9E%E3%83%93%E3%83%A5%E3%83%BC"},tip18:{en:"Fullscreen",cn:"%E5%85%A8%E5%B1%8F",jp:"%E5%85%A8%E7%94%BB%E9%9D%A2ON"},tip19:{en:"Exit Fullscreen",cn:"%E9%80%80%E5%87%BA%E5%85%A8%E5%B1%8F",jp:"%E5%85%A8%E7%94%BB%E9%9D%A2OFF"}},n=function(t,e,i){return void 0===t[e]?i:t[e]},s=function(){};s.extend=function(t){var i=function(){"function"==typeof this.init&&this.init.apply(this,arguments)};return i.prototype=t,i.constructor=i,i.prototype.api_screenShot=function(){return this.preserveDrawingBuffer?this.webGLCanvas.toDataURL("image/jpeg",1):""},i.prototype.api_readPixels=function(t,e,i,n){var r=new Uint8Array(i*n*4);return this.webGL.readPixels(t,e,i,n,this.webGL.RGBA,this.webGL.UNSIGNED_BYTE,r),r},i.prototype.api_getVideoFrame=function(t){var e=this.api_getVideoDom();if(t&&this.api_setVideoCurTime(t),!e)return null;var i=e.videoWidth||1920,n=e.videoHeight||960,r=JTUtil.cDom(this.toStrByUniCode([99,97,110,118,97,115]));return r.width=i,r.height=n,r.setAttribute("crossorigin","anonymous"),r.getContext("2d").drawImage(e,0,0,r.width,r.height),r.toDataURL("image/png",1)},i.prototype.api_stopAll=function(){this.clearOtherLoop()},i.prototype.api_autoPlay=function(){this.clearOtherLoop(),this.isAutoRotate&&this.api_right()},i.prototype.api_reset=function(){this.clearOtherLoop();var t=this.initPan,e=this.initTilt,i=this.initFov;this.curPan=parseInt(t),this.curTilt=parseInt(e),this.curFov=parseInt(i),this.setPanTiltFov()},i.prototype.api_left=function(){this.clearOtherLoop(),this.eventKeyCode=37,this.isGyro&&this.api_CloseGyro()},i.prototype.api_right=function(){this.clearOtherLoop(),this.eventKeyCode=39,this.isGyro&&this.api_CloseGyro()},i.prototype.api_up=function(){this.clearOtherLoop(),this.eventKeyCode=38,this.isGyro&&this.api_CloseGyro()},i.prototype.api_down=function(){this.clearOtherLoop(),this.eventKeyCode=40,this.isGyro&&this.api_CloseGyro()},i.prototype.api_zoomin=function(){this.clearOtherLoop(),this.eventKeyCode=16,this.isGyro&&this.api_CloseGyro()},i.prototype.api_zoomout=function(){this.clearOtherLoop(),this.eventKeyCode=17,this.isGyro&&this.api_CloseGyro()},i.prototype.api_previousScene=function(){this.clearOtherLoop();var t=this.curSceneNum-1;this.api_changerSceneByIndex(t)},i.prototype.api_nextScene=function(){this.clearOtherLoop();var t=this.curSceneNum+1;this.api_changerSceneByIndex(t)},i.prototype.api_changerSceneById=function(t,e,i,n){this.clearOtherLoop();var r=this.api_getSceneIndexById(t,e,i,n);this.api_changerSceneByIndex(r,e,i,n)},i.prototype.api_changerSceneByIndex=function(t,e,i,n,r,s){this.isPlay=!1,this.videoElement&&this.videoElement.pause(),this.clearOtherLoop(),this.createModel(t,e,i,n)},i.prototype.api_ToggleDragEffectMode=function(){return this.dragMode=!this.dragMode,this.dragMode},i.prototype.api_ToggleDragDirection=function(){return this.dragDirectionMode=!this.dragDirectionMode,this.dragDirectionMode},i.prototype.api_updateAngle=function(t){var e=this.getPan()+t;this.setPanOnly(e)},i.prototype.api_updateTiltAngle=function(t){var e=this.getTilt()+t;this.setTiltOnly(e)},i.prototype.api_updatePanTiltAngle=function(t,e){t=this.getPan()+t,e=this.getTilt()+e;this.setPanTilt(t,e)},i.prototype.api_setPanTiltFov=function(t,e,i){this.setPanTiltFov(t,e,i)},i.prototype.api_getSceneIndexById=function(t){for(var e,i=0;i<this.scenesArr.length;i++){if(this.scenesArr[i].sceneId==t){e=i;break}}return e},i.prototype.api_getCurSceneType=function(){return this.curSceneObj.sceneFileType},i.prototype.api_setCurSceneModel=function(t){this.curSceneObj.sceneModel=t||"Sphere";var e=this.webGL_getBuffer(this.curSceneObj);this.webGL_updateBuffer(e,this.curSceneObj)},i.prototype.api_getSceneDataById=function(t){var e=this.api_getSceneIndexById(t);return this.api_getSceneDataByIndex(e)},i.prototype.api_getSceneDataByIndex=function(t){return this.scenesArr[t]?this.scenesArr[t]:this.scenesArr[this.curSceneNum]},i.prototype.api_addJsonSceneData=function(t){var e=t.sceneId;if(!e)return null;var i=this.api_getSceneIndexById(e);return isNaN(i)?(this.scenesArr.push(t),e):e},i.prototype.api_delSceneById=function(t){var e=this.api_getSceneIndexById(t);-1!=e&&this.scenesArr.splice(e,1)},i.prototype.api_resize=function(t,e){this.setViewSize(t,e),this.onResizePlay(),this.sceneResizeCallBack&&this.sceneResizeCallBack()},i.prototype.api_CloseGyro=function(){return e.isMobile?(this.curRoll=0,this.isGyro=!1,this.api_setDragStatus(!0),stopGyroEffect(),this.setPanTiltFov(),this.isGyro):(this.isGyro=!1,!1)},i.prototype.api_OpenGyro=function(){return e.isMobile?(this,addGyroEffect&&addGyroEffect(this),this.isGyro=!0,this.isGyro):(this.isGyro=!1,!1)},i.prototype.api_ToggleGyro=function(){return this.isGyro?this.api_CloseGyro():this.api_OpenGyro()},i.prototype.api_getGyroStatus=function(){return this.isGyro},i.prototype.api_getViewPortStatus=function(){return this.isDBViewPort},i.prototype.api_setViewPortStatus=function(t){this.isDBViewPort=!!t,this.webGL_MUpdate(),this.sceneResizeCallBack&&this.sceneResizeCallBack()},i.prototype.api_getDragStatus=function(){return this.isDragAble},i.prototype.api_setDragStatus=function(t){this.isDragAble=!!t},i.prototype.api_formatEffectParams=function(t){var e,i,n,r,s,a,o,h,l,c=t[4]?t[4]:"none",u=t[5]?t[5]:2;switch(c){case"WalkThrough":r=this.getPan(),s=this.getTilt(),a=this.getFov(),o=1*t[6],h=1*t[7],l=1*t[8],e=1*t[9],i=1*t[10],n=1*t[11];break;default:e=t.pan||t[1],i=t.tilt||t[2],n=t.fov||t[3]}return{effectName:c,effectTime:1*u,nextPan:e,nextTilt:i,nextFov:n,sPan:r,sTilt:s,sFov:a,ePan:o,eTilt:h,eFov:l}},i.prototype.api_walkDefaultTilt=function(t,e){t=isNaN(t)?1:t;var i=this,n=this.getTilt();new r.Tween({tilt:n}).to({tilt:0},1e3*t).easing(r.Easing.Linear.None).onUpdate(function(){i.setTiltOnly(this.tilt)}).onComplete(function(){r.remove(this),"function"==typeof e&&e()}).start()},i.prototype.api_walkThrough=function(t,e,i,n,s){var a=this,o=(t=isNaN(t)?1:t,this.getPan()),h=this.getTilt(),l=this.getFov(),c=e-o,u=c>0?1:-1;(c=Math.abs(c))>180&&(c=360-c,u*=-1);var d=t/2,f=new r.Tween({pan:o,tilt:h}).to({pan:o+c*u,tilt:i},1e3*d).easing(r.Easing.Quadratic.Out).onUpdate(function(){a.setPanTilt(this.pan,this.tilt)}).onComplete(function(){r.remove(this),v.start()}),p=t/2,v=new r.Tween({fov:l}).to({fov:n},1e3*p).easing(r.Easing.Quadratic.Out).onUpdate(function(){a.setFovOnly(this.fov)}).onComplete(function(){r.remove(this),cancelAnimationFrame(null),a.api_stopAll(),"function"==typeof s&&s()});this.isGyro?v.start():f.start()},i.prototype.api_walkThroughVR=function(t,e,i){t=isNaN(t)?1:t;var n=this,s=this.getFov();new r.Tween({fov:s}).to({fov:e},1e3*t).easing(r.Easing.Quadratic.Out).onUpdate(function(){n.setFovOnly(this.fov)}).onComplete(function(){r.remove(this),n.api_stopAll(),"function"==typeof i&&i()}).start()},i.prototype.api_littlePlanet=function(t,e){t=isNaN(t)?1:t;var i=this,n=this.getPan(),s=this.getTilt(),a=this.getFov(),o=this.getCameraAt();new r.Tween({pan:n,tilt:s,fov:a,cat:o}).to({pan:this.initPan,tilt:-90,fov:150,cat:-.9},1e3*t).easing(r.Easing.Quadratic.Out).onUpdate(function(){i.setPanTiltFov(this.pan,this.tilt,this.fov),i.setCameraAt(this.cat)}).onComplete(function(){r.remove(this),i.isLittlePlanetEffect=!0,"function"==typeof e&&e()}).start()},i.prototype.api_SpherePlanet=function(t,e){t=isNaN(t)?1:t;var i=this,n=this.getPan(),s=this.getTilt(),a=this.getFov(),o=this.getCameraAt();new r.Tween({pan:n,tilt:s,fov:a,cat:o}).to({pan:0,tilt:-45,fov:100,cat:-.5},1e3*t).easing(r.Easing.Quadratic.Out).onUpdate(function(){i.setPanTiltFov(this.pan,this.tilt,this.fov),i.setCameraAt(this.cat)}).onComplete(function(){r.remove(this),i.isLittlePlanetEffect=!0,"function"==typeof e&&e()}).start()},i.prototype.api_normalView=function(t,e){t=isNaN(t)?1:t;var i=this,n=this.getPan(),s=this.getTilt(),a=this.getFov(),o=this.getCameraAt();new r.Tween({pan:n,tilt:s,fov:a,cat:o}).to({pan:this.initPan,tilt:0,fov:this.initFov,cat:0},1e3*t).easing(r.Easing.Quadratic.In).onUpdate(function(){i.setPanTiltFov(this.pan,this.tilt,this.fov),i.setCameraAt(this.cat)}).onComplete(function(){r.remove(this),i.isLittlePlanetEffect=!1,"function"==typeof e&&e()}).start()},i.prototype.api_initSceneEffect=function(t,e){var i=this.api_formatEffectParams(e);if("WalkThrough"==i.effectName){var n=(new Date).getTime();this.api_walkThrough(t,n,i)}else this.api_changerSceneByIndex(t,i.nextPan,i.nextTilt,i.nextFov,i.effectName,i.effectTime)},i.prototype.api_getCurSceneLngLat=function(){return{lng:this.sceneLng,lat:this.sceneLat}},i.prototype.api_screenToSphere=function(t,e){var i=this.get3DPanTiltByScreenXY(t,e);return{pan:i.pan,tilt:i.tilt,fov:this.getFov()}},i.prototype.api_sphereToScreen=function(t,e){var i=this.api_get3DXYZByPanTilt(t,e),n=this.api_3DXYZToScreen(i.x,i.y,i.z);return{x:n.x,y:n.y,roll:this.getRoll(),isShow:n.isInner,isInner:n.isInner}},i.prototype.api_get3DXYZByPanTilt=function(t,e){var i=t+90,n=e,r=mat4.create();mat4.rotateY(r,r,-i*Math.PI/180),mat4.rotateX(r,r,n*Math.PI/180),mat4.translate(r,r,[0,0,-1]);var s=vec3.transformMat4([],[0,0,0],r);return{x:s[0],y:s[1],z:s[2]}},i.prototype.api_3DXYZArrToScreen=function(t,e){var i=t.centerData,n=t.checkData,r=n.length,s=this.api_3DXYZToScreen(i[0],i[1],i[2]);if(s.isInner)return s;for(var a=0;a<r;a+=3){var o=n[a],h=n[a+1],l=n[a+2],c=this.api_3DXYZToScreen(o,h,l);if(c.isInner)return c}return{x:-1e3,y:-1e3,isInner:!1}},i.prototype.api_3DXYZToScreen=function(t,e,i){var n=[t,e,i,1],r=[],s=[],a=this.width,o=this.height;mat4.multiply(r,this.pMatrix,this.mvMatrix),vec4.transformMat4(s,n,r);t=s[0],e=s[1];if((i=s[2])<0)return{x:-1e3,y:-1e3,isInner:!1};this.isDBViewPort&&(this.width>this.height?(a=.5*this.width,o=this.height):(a=this.width,o=.5*this.height));var h=(t=t/i/2)*a+.5*a,l=-(e=e/i/2)*o+.5*o,c=!0;return(h<0||l<0||h>a||l>o)&&(c=!1),{x:h,y:l,isInner:c}},i.prototype.api_getCurSceneId=function(){return this.sceneId},i.prototype.api_getVideoDom=function(){return this.videoElement},i.prototype.api_setVideoDom=function(t){this.videoElement=t},i.prototype.api_getVideoLoadStartCallBack=function(){return this.videoLoadStartCallBack},i.prototype.api_getVideoLoadProgressCallBack=function(){return this.videoLoadProgressCallBack},i.prototype.api_getVideoPlayerCallBack=function(){return this.videoPlayerCallBack},i.prototype.api_getVideoUpdateCallBack=function(){return this.videoUpdateCallBack},i.prototype.api_getVideoLoadMetaDataCallBack=function(){return this.videoLoadMetaDataCallBack},i.prototype.api_IsBlackWebGL=function(){return this.isBlackWebGL},i.prototype.api_setVideoPlay=function(){this.videoElement&&(this.videoElement.ended&&(this.videoElement.currentTime=.1),this.videoElement.play(),this.videoElement.paused&&setTimeout(this.api_setVideoPlay,200),this.isPlay=!0,this.videoTogglePlayCallBack&&this.videoTogglePlayCallBack())},i.prototype.api_setVideoPause=function(){this.videoElement.pause(),this.isPlay=!1,this.videoTogglePlayCallBack&&this.videoTogglePlayCallBack()},i.prototype.api_setVideoMute=function(t){this.videoElement.muted=t},i.prototype.api_getVideoMute=function(){return this.videoElement.muted},i.prototype.api_getVideoAutoPlayStatus=function(){return this.isVideoAutoPlay},i.prototype.api_getVideoPlayStatus=function(){return this.isPlay},i.prototype.api_setVideoToggle=function(){"Image"!=this.sceneFileType&&(this.isPlay?this.api_setVideoPause():this.api_setVideoPlay())},i.prototype.api_setVideoCurTime=function(t){this.videoElement.currentTime=t,this.setVideoCurTimeCallBack&&this.setVideoCurTimeCallBack()},i.prototype.api_getVideoCurTime=function(t){return this.videoElement.currentTime},i.prototype.api_getCurScenePTF=function(){return{pan:this.getPan(),tilt:this.getTilt(),fov:this.getFov()}},i.prototype.api_getPlayDom=function(){return this.playDom},i.prototype.api_getTargetDom=function(){return this.target},i.prototype.api_getRotateStatus=function(){return!!this.eventKeyCode},i.prototype.api_getPlayerSize=function(){return{width:this.width,height:this.height,left:this.left,top:this.top}},i.prototype.api_getFovLength=function(){return this.getFovLength()},i.prototype.api_setMPMatrix=function(t,e){this.changerCallBackByGyro(t,e)},i.prototype.api_getAllSceneData=function(){return this.scenesArr},i.prototype.api_playerError=function(t){4==t?this.liveErrorTips():this.show2DVideo(this.videoElement,t),this.sendInfo(null,!0),this.delPlayTip(),this.errorStatus=!0,this.errorCallBack&&this.errorCallBack(t)},i.prototype.api_getWebGLInfo=function(){return{webGL:this.webGL,viewWidth:this.deviceWidth,viewHeight:this.deviceHeight,vertex:this.shaderParams.vertex,texture:this.shaderParams.texture}},i.prototype.api_getViewPortSize=function(){var t=this.webGL_getViewPortSize();return{wh:t.wh,w:t.w,h:t.h}},i.prototype.api_getCurMPMatrix=function(){return{mm:this.mvMatrix,pm:this.pMatrix}},i.prototype.api_formatTexture=function(t,e){this.webGL_formatTexture(t,e)},i.prototype.api_uploadMatrixUniforms=function(t,e,i){this.webGL_setProgram_Matrix(t,e,i)},i.prototype.api_setTextureSize=function(t,e,i,n){this.webGL_setProgram_TextureSize(t,e,i,n)},i.prototype.api_loadVideo=function(t){this.webGL_loadVideo(t)},i.prototype.api_setDBViewIPD=function(t){var e=1*t||.05;e<0&&(e=0),e>.15&&(e=.15),this.DBViewIPD=e},i.prototype.api_getDBViewIPD=function(){return this.DBViewIPD},i.prototype.api_getVRMode=function(){return this.isVRMode},i.prototype.api_enterVRModel=function(){return this.clearOtherLoop(),this.api_setViewPortStatus(!0),this.isVRMode=!0,this.DBViewIPD},i.prototype.api_exitVRModel=function(){return this.api_setViewPortStatus(!1),this.isVRMode=!1,this.DBViewIPD},i.prototype.api_setWebVRSensor=function(t,e,i){this.leftM=t,this.rightM=e,this.hmdMatrix=i},i.prototype.api_changeVideoPath=function(t,e,i,n,r){var s=isNaN(e)?this.videoElement.currentTime:e;i||this.sceneId;this.api_setVideoPause(),this.changeVideoPath(t,s,n,r)},i.prototype.api_changeScenePath=function(t,e){this.changeScenePath(t,e)},i.prototype.api_enterFullScreen=function(){if(!JTUtil.isSupportFullScreen())return!1;var t=this.fullScreenDom||this.target;this.enterFullScreen(t)},i.prototype.api_exitFullScreen=function(){if(!JTUtil.isSupportFullScreen())return!1;var t=this.fullScreenDom||this.target;this.exitFullScreen(t)},i.prototype.api_fullScreen=function(){if(!JTUtil.isSupportFullScreen())return!1;var t=this.fullScreenDom||this.target;return JTUtil.reqFullScreen(t)},i.prototype.api_getCurMVMatrix=function(){return this.mvMatrix},i.prototype.api_createVideoDom=function(){return this.loadVideoDom()},i.prototype.api_loadVideoDom=function(t,e,i,n,r){this.videoEvents={},this.loadVideo(t,e,i,n,r)},i.prototype.api_clearAll=function(){this.isPlay=!1,this.videoElement&&this.videoElement.pause(),this.videoElement=null,this.api_stopAll(),this.delteDrawSceneObjById(this.sceneId),this.webGL_clearAll(),this.sceneId=null},i.prototype.api_getGLMaxTextureSize=function(){return this.webGL.getParameter(this.webGL.MAX_TEXTURE_SIZE)},i};var a=s.extend({init:function(i){if(t=JTUtil.getLanguage(),e=JTUtil.getBrowser(),this.setBasicParams(i),this.setRecordParams(),this.setEventParams(),this.setPlayModeParams(i),this.setCallBackParams(i),this.setDomParams(),this.createView(),this.setVerTip(),this.checkDoMain(),this.checkAndroidBlackVideo(),this.checkPlay()){this.webGl_InitDefault(),this.addEventHanders(this.playDom),this.updateVerTip();var n=this.api_getSceneIndexById(this.initSceneId);this.initOverCallBack&&this.initOverCallBack(),this.createModel(n),this.webGL_start()}else this.updateVerTip(),this.api_playerError(0)},setSceneParams:function(t){var e={};return e.sceneId=n(t,"sceneId","")||n(t,"sceneName","myScene"),e.sceneName=n(t,"sceneName","myScene"),e.sceneTop=n(t,"sceneTop",0),e.sceneLeft=n(t,"sceneLeft",0),e.sceneLng=n(t,"sceneLng",""),e.sceneLat=n(t,"sceneLat",""),e.sceneWidth=n(t,"sceneWidth",0),e.sceneHeight=n(t,"sceneHeight",0),e.sceneFileType=n(t,"sceneFileType","")||n(t,"sceneType","Video"),e.sceneFilePath=n(t,"sceneFilePath","sence"),e.sceneModel=n(t,"sceneModel","Sphere"),e.sceneFormat=n(t,"sceneFormat","")||n(t,"videoType",""),this.sceneSpeed=n(t,"sceneSpeed",8),e.sceneBlockModel=n(t,"sceneBlockModel",null),e.isVideoAutoPlay=n(t,"isVideoAutoPlay",!1),e.isAutoRotate=!!n(t,"isAutoRotate",!1),e.isVideoLoop=n(t,"isVideoLoop",!0),e.minPan=n(t,"minPan",0),e.initPan=n(t,"initPan",180),e.maxPan=n(t,"maxPan",360),e.minTilt=n(t,"minTilt",-90),e.initTilt=n(t,"initTilt",0),e.maxTilt=n(t,"maxTilt",90),e.initFov=n(t,"initFov",90),e.minFov=n(t,"minFov",10),e.maxFov=n(t,"maxFov",150),e.fovType=n(t,"fovType","Auto"),e.curFov=n(t,"curFov",0),e.curTilt=n(t,"curTilt",0),e.curPan=n(t,"curPan",0),e.curRoll=n(t,"curRoll",0),e.cameraAt=n(t,"cameraAt",0),e.isLittlePlanetEffect=n(t,"isLittlePlanetEffect",!1),e.webGLDrawType="Auto",e.Alpha=0,e.loadOver=!1,e},setSceneValue:function(t,e,i,n){if(t)for(var r in t.isLittlePlanetEffect?(t.curPan=0,t.curTilt=-90,t.curFov=150,t.cameraAt=-.9):(t.curPan=1*(e||t.initPan),t.curTilt=1*(i||t.initTilt),t.curFov=1*(n||t.initFov),t.cameraAt=1*t.cameraAt||0,this.isGyro&&(t.curTilt=0)),t)this[r]=t[r];else this.minPan=0,this.initPan=180,this.maxPan=180,this.minTilt=-90,this.initTilt=0,this.maxTilt=90,this.initFov=90,this.minFov=10,this.maxFov=150,this.fovType="Auto",this.curFov=90,this.curTilt=0,this.curPan=90,this.curRoll=0,this.cameraAt=0},initSceneParams:function(t){var e=this.scenesArr.length;t=(t=1*t?1*t:0)<0?e-1:t>=e?0:t;var i=this.api_getSceneDataByIndex(t);if(i&&this.sceneId!=i.sceneId){this.destroySceneId=this.sceneId,this.curSceneNum=t;var n=this.getDrawSceneObjById(this.destroySceneId);return n&&(n.mvMatrix=this.mvMatrix,n.pMatrix=this.pMatrix),this.setSceneParams(i)}},initSceneDrawType:function(t){if(t){var i=e.plat,n=t.sceneFilePath,r=JTUtil.getFileExt(n),s=this.ua.toLowerCase();".m3u8"!=r||"iphone"!=i&&"ipod"!=i&&"ipad"!=i||(t.webGLDrawType="Canvas");var a=/AppleWebKit\/(\d+\.\d)/i.test(this.ua)?1*RegExp.$1:null;a&&a>=602&&a<604&&(t.webGLDrawType="Auto"),s.match(/edge|msie|trident/)&&(t.webGLDrawType="Canvas")}},addModelEvent:function(t){t.draw=function(){"Canvas"==t.webGLDrawType&&"Video"==t.sceneFileType?this.webGL_updateVideoTexture(t):"Video"==t.sceneFileType&&this.isPlay&&this.webGL_updateVideoTexture(t),this.webGL_bindBuffer(t),"Sphere"==t.sceneModel?this.webGL_drawSphere(t):"Pyramid"==t.sceneModel?this.webGL_drawPyramid(t):"Flat"==t.sceneModel&&this.webGL_Flat(t)}.bind(this)},createModel:function(e,n,r,s){if(this.curSceneObj=this.initSceneParams(e),this.initSceneDrawType(this.curSceneObj),this.webGL_setProgram_ColorFormat(this.curSceneObj),this.setSceneValue(this.curSceneObj,n,r,s),this.curSceneObj){this.checkPanTiltFov(),this.webGL_MUpdate();var a=this.webGL_getBuffer(this.curSceneObj);this.webGL_setBuffer(a,this.curSceneObj),this.addModelEvent(this.curSceneObj),this.webGL_clearAll(),this.sceneObjList.push(this.curSceneObj),this.setPlayTip(decodeURI(i.tip0[t])),"Video"==this.curSceneObj.sceneFileType?this.webGL_loadVideo(this.curSceneObj):"Image"==this.curSceneObj.sceneFileType&&this.webGL_loadImage(this.curSceneObj),this.loadedStartCallBack&&this.loadedStartCallBack()}},enterFullScreen:function(t){t=t||document.documentElement;!!JTUtil.isFullScreen()||(t.requestFullScreen&&t.requestFullScreen(),t.webkitRequestFullScreen&&t.webkitRequestFullScreen(),t.msRequestFullscreen&&t.msRequestFullscreen(),t.mozRequestFullScreen&&t.mozRequestFullScreen(),t.oRequestFullScreen&&t.oRequestFullScreen())},exitFullScreen:function(){!!JTUtil.isFullScreen()&&(document.exitFullscreen&&document.exitFullscreen(),document.cancelFullScreen&&document.cancelFullScreen(),document.webkitCancelFullScreen&&document.webkitCancelFullScreen(),document.msExitFullscreen&&document.msExitFullscreen(),document.mozCancelFullScreen&&document.mozCancelFullScreen(),document.oCancelFullScreen&&document.oCancelFullScreen())},formatSceneType:function(t,e,i){var n=0;"Image"==t&&(n=10),"Video"==t&&(n=20);var r=0;return"2D"==e&&(r=0),"LR3D"==e&&(r=1),"UD3D"==e&&(r=2),i?-1:n+r},getTopDomain:function(){var t="";try{t=window.top==window?"":top.location.href}catch(e){t=""}return t},sendInfo:function(t,e){if(t&&"file:"!=this.wl.protocol){var i=t.sceneWidth?t.sceneWidth:0,n=t.sceneHeight?t.sceneHeight:1,r=new Image,s=this.toStrByUniCode([47,47,97,46,117,116,111,118,114,46,99,111,109,47,116,46,112,110,103]),a=this.getTopDomain(),o=encodeURIComponent(a),h=this.toStrByUniCode(this.getVersionNum()),l=this.authorizeName.join("_"),c=this.formatSceneType(t.sceneFileType,t.sceneFormat,e),u=(i/n).toFixed(2),d=i+"_"+n,f=this.toStrByUniCode([104]);s+=this.toStrByUniCode([63,117,116,61,49]),o&&(s+=this.toStrByUniCode([38,100,61])+o),h&&(s+=this.toStrByUniCode([38,118,61])+h),l&&(s+=this.toStrByUniCode([38,107,61])+l),c&&(s+=this.toStrByUniCode([38,116,61])+c),u&&(s+=this.toStrByUniCode([38,115,61])+u),s+=this.toStrByUniCode([38,97,61])+360,d&&(s+=this.toStrByUniCode([38,119,61])+d),f&&(s+=this.toStrByUniCode([38,109,61])+f);this.toStrByUniCode(this.authorizeName);r.src=s}},checkDoMain:function(){var t=this.wl,e=t[this.toStrByUniCode([104,111,115,116,110,97,109,101])],i=this.toUnicodeByStr(e).join("");if(1===this.CRType&&"undefined"!=typeof JTC&&"undefined"!=typeof JTR&&1==JTR)return this.isShowSDK=!1,this.isRightClick=!1,void(this.isLive=!0);if("222.198.115.66"===e)return this.isShowSDK=!1,this.isRightClick=!1,void(this.isLive=!0);if("file:"==t[this.toStrByUniCode([112,114,111,116,111,99,111,108])])return!1;for(var n=-1,r=0;r<this.hostList.length;r++){var s=this.hostList[r].join("");if(-1!=i.indexOf(s)){n=r;break}}if(-1!==n){if(this.authorizeName=this.hostList[n],0===n||3===n||4===n||5===n||46===n||47===n||42===n||43===n||67===n||69===n||70===n||75===n||76===n||77===n||81===n||82===n||83===n||85===n||96===n||97===n)return this.isShowSDK=!1,void(this.isRightClick=!1);if(6===n||11===n||12===n||16===n||18===n||19===n||20===n||21===n||29===n||30===n||31===n||34==n||38==n)return this.isShowSDK=!1,this.isRightClick=!0,void(this.isLive=!0);if(1!==n&&2!==n&&22!==n&&24!==n&&25!==n&&28!=n&&40!=n&&39!==n){if(10===n||23===n||32===n||33===n||53===n||48===n||49===n||50===n||61===n||62===n||65===n||68===n||7===n||8===n||9===n||13===n||71===n||72===n||73===n||90===n||93===n||94===n||26===n||101===n)return this.isShowSDK=!1,this.isRightClick=!1,void(this.isLive=!0);if(14!==n&&15!==n&&17!==n&&27!==n){var a=(new Date).getTime();86!==n?92!==n&&93!==n?35!==n?36!==n?37!==n?41!==n?44!==n&&45!==n?51!==n?52!==n?58!==n?59!==n?102!==n&&60!==n?63!==n?64!==n?66!==n?74!==n?78!==n&&79!==n?80!==n?84!==n?87!==n&&88!==n&&89!==n?98!==n?99!==n?100!==n||a<1551944613942&&(this.isShowSDK=!1,this.isRightClick=!1,this.isLive=!0):a<1549009809442&&(this.isShowSDK=!1,this.isRightClick=!1):a<1522317702383&&(this.isRightClick=!1,this.isLive=!0):a<1539238217873&&(this.isShowSDK=!1,this.isRightClick=!1,this.isLive=!0):a<1535767955414&&(this.isShowSDK=!1,this.isRightClick=!1,this.isLive=!0):a<1503283406411&&(this.isLive=!0):a<1532415403613&&(this.isShowSDK=!1,this.isRightClick=!1,this.isLive=!0):a<1530087082257&&(this.isShowSDK=!1,this.isRightClick=!1,this.isLive=!0):a<1529823637044&&(this.isShowSDK=!1,this.isRightClick=!1,this.isLive=!0):a<15238944e5&&(this.isShowSDK=!1,this.isRightClick=!1,this.isLive=!0):a<149266983e4&&(this.isShowSDK=!1,this.isRightClick=!1,this.isLive=!0):a<1556703065526&&(this.isShowSDK=!1,this.isRightClick=!1,this.isLive=!0):a<1528695136486&&(this.isShowSDK=!1,this.isRightClick=!1,this.isLive=!0):a<1527821843058&&(this.isShowSDK=!1,this.isRightClick=!1,this.isLive=!0):a<1527412065494&&(this.isShowSDK=!1,this.isRightClick=!1,this.isLive=!0):a<1527412065494&&(this.isShowSDK=!1,this.isRightClick=!1,this.isLive=!1):a<1525943823575&&(this.isShowSDK=!1,this.isRightClick=!1,this.isLive=!0):a<1525153217345&&(this.isShowSDK=!1,this.isRightClick=!1):a<1491472632606&&(this.isShowSDK=!1,this.isRightClick=!0,this.isLive=!0):a<1499331710824&&(this.isShowSDK=!1,this.isRightClick=!0,this.isLive=!0):a<1488162183430&&(this.isShowSDK=!1,this.isRightClick=!0,this.isLive=!0):a<1528694122881&&(this.isShowSDK=!1,this.isRightClick=!1,this.isLive=!1):a<1519269065928?(this.isShowSDK=!1,this.isRightClick=!1,this.isLive=!0):(this.isShowSDK=!1,this.isRightClick=!1,this.isLive=!1)}else this.isLive=!0}else this.isShowSDK=!1}},toUnicodeByStr:function(t){for(var e=[],i=0;i<t.length;i++)e.push(t.charCodeAt(i));return e},toStrByUniCode:function(t){for(var e=[],i=0;i<t.length;i++)e.push(String.fromCharCode(t[i]));return e.join("")},getVersionNum:function(){return[49,46,48,46,49,49,56,56]},getVersion:function(){var t;return t=1===this.CRType?[74,73,69,84,85,83,79,70,84,32,83,68,75,32]:[85,116,111,86,82,32,80,108,97,121,101,114,32,83,68,75,32],this.toStrByUniCode(t)+this.toStrByUniCode(this.getVersionNum())},setBasicParams:function(t){this.container=n(t,"container",document.body),this.name=n(t,"name","UTPlayer"),this.width=n(t,"width",800),this.height=n(t,"height",600),this.zIndex=n(t,"zIndex",0),this.loadingImg=n(t,"loadingImg",""),this.ua=navigator.userAgent,this.loadingImg&&(i.tip0.en=this.loadingImg,i.tip0.cn=this.loadingImg,i.tip0.jp=this.loadingImg)},setPlayModeParams:function(t){this.isMouseWheel=n(t,"isMouseWheel",!0),this.isDBClick=n(t,"isDBClick",!0),this.isDBViewPort=n(t,"isDBViewPort",!1),this.isVRMode=!1,this.DBViewIPD=n(t,"DBViewIPD",0),this.CRType=n(t,"CRType",0),this.CRImage=n(t,"CRImage",""),this.initSceneId=n(t,"initSceneId",""),this.isGyro=n(t,"isGyro",!1),this.isDragAble=n(t,"isDragAble",!0),this.dragStarMode=n(t,"dragStarMode","mdown"),this.dragMode=n(t,"dragMode",!1),this.dragSpeed=.1,this.dragDirectionMode=n(t,"dragDirectionMode",!0),this.preserveDrawingBuffer=n(t,"webGLDeepBuffer",!1),this.scenesArr=n(t,"scenesArr",[]),this.isBlackWebGL=n(t,"isBlackWebGL",!1),this.isLive=!1,this.isLivePath=!1,this.authorizeName=[102,114,101,101],this.isShowSDK=!0,this.isShowCR=!1,this.isRightClick=!0,this.fullScreenDom=n(t,"fullScreenDom",null),e.isMobile||(this.isGyro=!1)},setCallBackParams:function(t){this.initOverCallBack=n(t,"initOverCallBack",null),this.loadedStartCallBack=n(t,"loadedStartCallBack",null),this.loadedCallBack=n(t,"loadedCallBack",null),this.drawWebGLCallBack=n(t,"drawWebGLCallBack",null),this.errorCallBack=n(t,"errorCallBack",null),this.sceneResizeCallBack=n(t,"sceneResizeCallBack",null),this.scenePanTiltFovChangerCallBack=n(t,"scenePanTiltFovChangerCallBack",null),this.sceneEventMoveCallBack=n(t,"sceneEventMoveCallBack",null),this.sceneEventUpCallBack=n(t,"sceneEventUpCallBack",null),this.sceneEventClickCallBack=n(t,"sceneEventClickCallBack",null),this.sceneEventDownCallBack=n(t,"sceneEventDownCallBack",null),this.fullScreenChangeCallBack=n(t,"fullScreenChangeCallBack",null),this.videoLoadProgressCallBack=n(t,"videoLoadProgressCallBack",null),this.videoLoadStartCallBack=n(t,"videoLoadStartCallBack",null),this.videoPlayerCallBack=n(t,"videoPlayerCallBack",null),this.videoCanPlayerCallBack=n(t,"videoCanPlayerCallBack",null),this.videoUpdateCallBack=n(t,"videoUpdateCallBack",null),this.videoLoadMetaDataCallBack=n(t,"videoLoadMetaDataCallBack",null),this.videoTogglePlayCallBack=n(t,"videoTogglePlayCallBack",null),this.setVideoCurTimeCallBack=n(t,"setVideoCurTimeCallBack",null),this.videoPlayEndCallBack=n(t,"videoPlayEndCallBack",null),this.X5VideoExitFullscreen=n(t,"X5VideoExitFullscreen",null),this.X5VideoEnterFullscreen=n(t,"X5VideoEnterFullscreen",null),this.changeSucessCallBack=n(t,"changeSucessCallBack",null),this.changeErrorCallBack=n(t,"changeErrorCallBack",null)},setInitSize:function(){var t=DomUtil.getSize(this.target);this.api_resize(t.width,t.height);window.addResizeListener(this.target,EventUtil.debounce(function(){var t=DomUtil.getSize(this.target);this.api_resize(t.width,t.height)},100,!0).bind(this));e.plat;var i=this,n=new(window.MutationObserver||window.WebKitMutationObserver||window.MozMutationObserver)(function(t){JTUtil.gId("scenePlayDom")||(i.api_setVideoPause(),i.videoElement=null,n.disconnect())});n.observe(document.body,{childList:!0,subtree:!0})},setRecordParams:function(){this.pMatrix=mat4.create(),this.mvMatrix=mat4.create(),this.deviceWidth=0,this.deviceHeight=0,this.curSceneNum=0,this.wl=window.location,this.destroySceneId=null},setEventParams:function(){this.isEventDown=!1,this.isEventWheel=!1,this.startDragX=0,this.startDragY=0,this.curDragX=0,this.curDragY=0,this.lastTime=0,this.eventKeyCode=0,this.startScaleNum=0,this.countWheelNum=0,this.fovLength=0,this.hostList=[[99,104,105,110,97,110,101,119,115,46,99,111,109],[99,110,116,118,46,99,110],[105,112,97,110,100,97,46,99,111,109],[56,49,46,99,110],[55,50,48,121,117,110,46,99,111,109],[55,50,48,115,116,97,116,105,99,46,99,111,109],[117,116,111,118,114,46,99,111,109],[122,104,111,110,103,103,117,111,119,97,110,103,115,104,105,46,99,111,109],[120,105,110,104,117,97,97,112,112,46,99,111,109],[120,105,110,104,117,97,109,109,46,110,101,116],[104,117,97,119,101,105,46,99,111,109],[115,110,97,105,108,118,114,46,99,111,109],[119,104,97,108,101,121,45,118,114,46,99,111,109],[56,55,56,55,48,46,99,111,109],[122,106,111,108,46,99,111,109],[115,111,98,101,121,99,108,111,117,100,46,99,111,109],[117,116,111,118,114,46,99,110],[117,116,111,118,114,104,108,115,112,108,97,121,46,100,110,105,111,110,46,99,111,109],[119,121,122,99,46,99,111,109],[103,107,107,46,99,110],[117,112,52,103,46,99,111,109],[107,101,122,104,117,97,110,106,105,97,46,99,111,109],[99,108,105,99,107,45,118,46,99,111,109],[109,105,103,117,99,108,111,117,100,46,99,111,109],[104,117,105,120,105,97,111,101,114,46,99,111,109],[98,97,111,109,105,104,117,97,46,99,111,109],[99,122,116,118,46,99,111,109],[120,105,110,104,117,105,119,101,110,46,99,111,109],[118,114,99,100,107,106,46,99,111,109],[99,121,106,120,46,99,111,109],[116,111,117,99,104,101,118,46,99,111,109],[116,115,121,116,118,46,99,111,109,46,99,110],[108,105,119,118,114,46,99,111,109],[104,108,115,46,108,105,119,46,100,110,105,111,110,46,99,111,109],[99,99,116,118,46,99,111,109],[115,117,112,101,114,115,116,97,114,99,111,108,108,101,99,116,105,111,110,115,46,99,111,109],[109,111,106,105,110,103,46,99,110],[108,101,99,108,111,117,100,46,99,111,109],[122,101,114,111,109,111,110,105,116,111,114,46,99,111,109],[106,105,110,103,106,105,114,105,98,97,111,46,99,110],[106,102,106,98,97,112,112,46,99,110],[118,114,45,115,104,111,119,115,46,99,110],[109,97,100,118,51,54,48,46,99,111,109],[109,97,100,118,51,54,48,46,99,110],[119,101,99,104,97,110,103,46,110,101,116],[122,109,105,116,105,46,99,111,109],[112,101,97,114,118,105,100,101,111,46,99,111,109],[112,101,97,114,109,101,100,105,97,46,99,110],[116,97,97,103,111,111,46,99,111,109],[116,97,97,103,111,111,46,99,110],[120,105,97,111,121,117,97,110,121,111,117,46,99,110],[100,100,105,112,105,110,103,46,99,111,109],[119,111,110,105,117,99,108,111,117,100,46,99,111,109],[115,104,105,107,111,110,103,46,116,118],[117,112,97,110,111,46,99,110],[117,112,97,110,111,118,114,46,99,111,109],[117,112,97,110,111,46,108,105,118,101],[117,112,97,110,111,46,110,101,116],[109,105,97,111,109,114,46,99,111,109],[107,101,121,110,111,46,99,110],[104,111,115,118,114,46,99,110],[101,97,115,121,118,97,97,115,46,99,111,109],[121,122,98,46,116,118],[112,121,114,97,109,105,100,118,114,46,99,110],[110,103,98,108,97,98,46,99,111,109],[121,105,122,104,105,98,111,46,116,118],[122,115,108,105,118,101,46,116,111,112],[99,105,116,121,56,46,99,111,109],[103,111,116,110,46,99,110],[120,105,97,111,121,105,46,99,111,109],[121,105,116,101,99,104,110,111,108,111,103,121,46,99,111,109],[120,105,97,111,112,97,110,111,46,99,111,109],[116,97,97,103,111,111,46,110,101,116],[99,104,105,110,97,109,111,110,115,46,99,111,109],[55,50,48,118,118,46,99,111,109],[102,112,104,105,115,46,99,111,109],[120,105,110,121,105,108,105,110,107,46,99,111,109],[110,101,116,105,109,101,46,99,111,109,46,99,110],[114,105,112,112,108,101,45,99,111,114,112,46,99,111,109],[99,104,97,110,101,108,46,99,111,109,46,99,110],[114,101,97,100,105,116,101,99,46,99,111,109],[100,97,114,108,105,110,103,46,99,110],[112,114,111,116,114,117,108,121,46,99,111,109,46,99,110],[98,113,108,110,118,46,99,111,109,46,99,110],[116,118,49,56,57,46,99,111,109],[111,117,114,106,105,97,110,103,115,117,110,46,99,111,109],[106,115,116,118,46,99,111,109],[122,104,105,49,48,46,99,111,109],[122,104,105,104,101,100,111,110,103,102,97,110,103,46,99,111,109],[122,104,119,101,98,105,110,97,114,46,99,111,109],[122,111,108,46,99,111,109,46,99,110],[49,48,48,56,54,46,99,110],[115,109,97,114,116,46,99,111,109],[106,97,101,97,112,112,46,99,111,109],[99,99,116,118,52,103,46,99,111,109],[105,99,104,101,110,103,122,105,46,99,111,109],[104,111,109,101,119,101,98,46,99,110],[108,105,108,108,121,97,100,109,105,110,46,99,110],[122,106,111,108,46,99,111,109,46,99,110],[104,107,115,111,102,116,46,99,110],[119,120,106,121,46,99,111,109,46,99,110],[106,115,101,99,111,110,111,109,121,46,99,111,109],[104,111,115,115,107,121,46,99,111,109]]},setDomParams:function(){this.target=null,this.playDom=null,this.cubeDom=null},createView:function(){this.target=JTUtil.cDom("div"),DomUtil.setProperties(this.target,{name:this.name}),DomUtil.setStyles(this.target,{position:"absolute",overflow:"hidden",width:"100%",height:"100%",backgroundColor:"black",left:"0px",top:"0px",zIndex:this.zIndex}),DomUtil.inject(this.target,this.container),this.playDom=JTUtil.cDom("div"),DomUtil.setProperties(this.playDom,{id:"scenePlayDom",tabIndex:-1}),DomUtil.setStyles(this.playDom,{position:"absolute",overflow:"hidden",height:"100%",width:"100%",outline:"none"}),DomUtil.inject(this.playDom,this.target),this.playDom.style[e.prefix+"UserSelect"]="none",this.playDom.style[e.prefix+"TouchAction"]="none",this.playDom.style[e.prefix+"ContentZooming"]="none",this.cubeDom=JTUtil.cDom("div"),DomUtil.setProperties(this.cubeDom,{id:"cubeDom"}),DomUtil.setStyles(this.cubeDom,{position:"absolute",width:"100%",height:"100%",pointerEvents:"none"}),DomUtil.inject(this.cubeDom,this.playDom)},checkAndroidBlackVideo:function(){this.isBlackWebGL=!1;var t=e.plat,i=this.ua,n=/chrome\//i.test(i),r=/chrome\/(\d+\.\d)/i.test(i)?1*RegExp.$1:null,s=/AppleWebKit\/(\d+\.\d)/i.test(i)?1*RegExp.$1:null,a=/MQQBrowser\/(\d+\.\d)/i.test(i)?1*RegExp.$1:null,o=/UCBrowser\//i.test(i),h=/SogouMobileBrowser\//i.test(i),l=/MiuiBrowser\//i.test(i),c=/Firefox\//i.test(i),u=/Version\/4.0 Mobile/i.test(i),d=/baiduboxapp\//i.test(i),f=/baidubrowser\//i.test(i),p=/TBS\/(\d+)/i.test(i)?1*RegExp.$1:null;"android"==t&&(n&&r<42&&(this.isBlackWebGL=!0),s&&s<537&&(this.isBlackWebGL=!0),l&&(this.isBlackWebGL=!0),o&&(this.isBlackWebGL=!0),h&&(this.isBlackWebGL=!0),c&&(this.isBlackWebGL=!0),u&&(this.isBlackWebGL=!0),d&&(this.isBlackWebGL=!0),f&&(this.isBlackWebGL=!0),/chrome\/45.0.2454.94/i.test(i)&&(this.isBlackWebGL=!1),/chrome\/44.0.2403.133/i.test(i)&&(this.isBlackWebGL=!1),a&&a>=7&&(this.isBlackWebGL=!1),p&&p>=36824&&(this.isBlackWebGL=!1)),"iphone"!=t&&"ipod"!=t&&"ipad"!=t||(o&&(this.isBlackWebGL=!0),a&&(this.isBlackWebGL=!0))},checkPlay:function(){return!!JTUtil.support_WebGL()},checkIsDebugMode:function(){this.wl.search.indexOf("debug=true")>0?this.isDBug=!0:this.isDBug=!1},setVerTip:function(){this.checkIsDebugMode(),this.isDBug&&(this.verDom=JTUtil.cDom("div"),DomUtil.setStyles(this.verDom,{position:"absolute",left:"50%",top:"50%",color:"rgb(255, 255, 255)",fontSize:"14px",zIndex:9999,pointerEvents:"none"}),DomUtil.inject(this.verDom,this.target),this.verTextDom=JTUtil.cDom("div"),DomUtil.setStyles(this.verTextDom,{position:"relative",left:"-50%",top:"-50%",lineHeight:"100%",textShadow:"rgb(0, 0, 0) 1px 1px 2px"}),DomUtil.inject(this.verTextDom,this.verDom),this.verCenterDom=JTUtil.cDom("center"),DomUtil.inject(this.verCenterDom,this.verTextDom),DomUtil.setStyles(this.verCenterDom,{display:"block",textAlign:"center"}))},updateVerTip:function(){if(this.isDBug){var t="ver: "+this.toStrByUniCode(this.getVersionNum())+" w： "+this.width+"h： "+this.height+" ua: "+this.ua;this.verCenterDom&&(this.verCenterDom.innerHTML=t)}},setPlayTip:function(t){this.delPlayTip(),this.tipDom=JTUtil.cDom("div"),DomUtil.setStyles(this.tipDom,{position:"absolute",left:"50%",top:"30%",color:"rgb(255, 255, 255)",fontSize:"24px",zIndex:9999,opacity:.7,pointerEvents:"none"}),DomUtil.inject(this.tipDom,this.target),this.tipTextDom=JTUtil.cDom("div"),DomUtil.setStyles(this.tipTextDom,{position:"relative",left:"-50%",top:"-25px",lineHeight:"110%",textShadow:"rgb(0, 0, 0) 1px 1px 2px"}),DomUtil.inject(this.tipTextDom,this.tipDom),this.tipCenterDom=JTUtil.cDom("center"),DomUtil.setStyles(this.tipCenterDom,{display:"block",textAlign:"center"}),DomUtil.inject(this.tipCenterDom,this.tipTextDom),this.tipCenterDom.innerHTML=t},delPlayTip:function(){this.tipDom&&DomUtil.destroy(this.tipDom)},liveErrorTips:function(){var t=JTUtil.cDom("div");DomUtil.setStyles(t,{position:"absolute",left:"50%",top:"50%",width:"280px",zIndex:1,marginTop:"-105px",marginLeft:"-140px",backgroundColor:"white",borderRadius:"10px",overflow:"hidden"}),DomUtil.inject(t,this.target);var e=JTUtil.cDom("div");DomUtil.setStyles(e,{position:"relative",padding:"20px",textAlign:"center",color:"gray"}),DomUtil.inject(e,t),e.innerHTML=this.toStrByUniCode([30452,25773,25480,26435,35831,32852,31995,65306,60,98,114,62,60,98,114,62,30005,35805,65306,48,50,49,45,53,48,50,55,54,49,57,50,32,60,98,114,62,60,98,114,62,25163,26426,58,49,51,52,56,50,51,53,55,49,52,55,32,60,98,114,62,60,98,114,62,81,81,65306,57,52,51,54,48,49,49,57,57])},degToRad:function(t){return t*Math.PI/180},get3DPanTiltByScreenXY:function(t,e){t=-(t-this.width/2),e=-(e-this.height/2);var i=this.pMatrix,n={x:t/(this.width/2)/i[0],y:-e/(this.height/2)/i[5],z:1,w:0},r=mat4.clone(this.mvMatrix);r=mat4.transpose(r,r),n={x:1e3*(n=vec4.transformMat4([],[n.x,n.y,n.z,n.w],r))[0],y:1e3*n[1],z:1e3*n[2],w:1e3*n[3]};var s=180*-Math.atan2(n.y,Math.sqrt(n.x*n.x+n.z*n.z))/Math.PI,a=180*Math.atan2(n.x,n.z)/Math.PI%360;return{pan:Math.abs((a-270)%360),tilt:s}},getDeviceDPI:function(){return this.ua.indexOf("AppleWebKit/533")>=0?1:window.devicePixelRatio?window.devicePixelRatio:1},setViewSize:function(t,e){this.width=parseInt(t)||window.innerWidth,this.height=parseInt(e)||window.innerHeight;var i=this.getDeviceDPI();this.deviceWidth=this.width*i,this.deviceHeight=this.height*i,this.b3="WnGjwbEXli9G1E5VMCMNf1lVCZsR5AFEHthdbMSPSoxgcq7592oQC"},autoSetPlayMode:function(t){var e="2D";if(t.sceneFormat)(2==t.sceneFormat||"2D"==t.sceneFormat)&&(e="2D"),(4==t.sceneFormat||"UD3D"==t.sceneFormat)&&(e="UD3D"),(5==t.sceneFormat||"LR3D"==t.sceneFormat)&&(e="LR3D");else{var i=t.sceneWidth/t.sceneHeight;e=1===i?"UD3D":4===i?"LR3D":"2D"}t.sceneFormat=e},playDomShow:function(t){var e=this;new r.Tween({alpha:t.Alpha}).to({alpha:1},800).easing(r.Easing.Quadratic.Out).onUpdate(function(){t.Alpha=this.alpha}).onComplete(function(){r.remove(this),e.delteDrawSceneObjById(e.destroySceneId),e.webGL_loadAllBlockObj(),e.api_autoPlay(),e.loadedCallBack&&e.loadedCallBack()}).start()},getSupportedCompressedTextureType:function(t){for(var e=t.getSupportedExtensions(),i=["s3tc","etc1","pvrtc"],n=0;n<e.length;n++)for(var r=0;r<i.length;r++)if(e[n].indexOf(i[r])>0){var s=t.getExtension(e[n]),a=t.getParameter(t.COMPRESSED_TEXTURE_FORMATS);return{type:i[r],extension:s,formats:a}}},webGL_initCanvas:function(){this.webGLCanvas=JTUtil.cDom(this.toStrByUniCode([99,97,110,118,97,115])),DomUtil.setStyles(this.webGLCanvas,{position:"absolute",width:"100%",height:"100%",left:"0px",top:"0px"}),DomUtil.inject(this.webGLCanvas,this.cubeDom)},webGL_initWebGL:function(){for(var t=null,e={alpha:!1,depth:!1,stencil:!1,antialias:!0,premultipliedAlpha:!0,preserveDrawingBuffer:this.preserveDrawingBuffer},i=0;i<4&&!(t=this.webGLCanvas.getContext(["webgl","experimental-webgl","moz-webgl","webkit-3d"][i],e));i++);t.frontFace(t.CCW),t.enable(t.CULL_FACE),t.cullFace(t.BACK),t.enable(t.BLEND),t.blendFunc(t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA),this.webGL=t},webGL_clear:function(){this.webGL.clearColor(0,0,0,1)},webGL_resizeWebGl:function(){this.webGL&&(this.webGL_clear(),this.webGLCanvas.width=this.deviceWidth,this.webGLCanvas.height=this.deviceHeight,this.webGLCanvas.style.width=this.width+"px",this.webGLCanvas.style.height=this.height+"px")},webGL_createShader:function(t,e){var i=this.webGL.createShader(t);return this.webGL.shaderSource(i,e.join("\n")),this.webGL.compileShader(i),this.webGL.getShaderParameter(i,this.webGL.COMPILE_STATUS),i},webGL_initShaders:function(t,e){var i=this.webGL.createProgram(),n=this.webGL_createShader(this.webGL.VERTEX_SHADER,t),r=this.webGL_createShader(this.webGL.FRAGMENT_SHADER,e);return this.webGL.attachShader(i,n),this.webGL.attachShader(i,r),this.webGL.linkProgram(i),this.webGL.deleteShader(n),this.webGL.deleteShader(r),this.webGL.getProgramParameter(i,this.webGL.LINK_STATUS)||console.log("Shader Error!"),i},webGL_initAllShaders:function(){this.defaultShaderObj=this.webGL_initShaders(this.vShaderSource,this.fShaderSource),this.webGL_useProgram(),this.webGL_getShadersParams(this.defaultShaderObj)},webGL_useProgram:function(t){var e=t||this.defaultShaderObj;this.webGL.useProgram(e)},webGL_getShadersParams:function(t){t=t||this.defaultShaderObj,this.shaderParams.vertex=this.webGL.getAttribLocation(t,"aVertex"),this.shaderParams.texture=this.webGL.getAttribLocation(t,"aTexture"),this.shaderParams.textureScaleX=this.webGL.getUniformLocation(t,"aTextureScaleX"),this.shaderParams.textureScaleY=this.webGL.getUniformLocation(t,"aTextureScaleY"),this.shaderParams.textureOffsetX=this.webGL.getUniformLocation(t,"aTextureOffsetX"),this.shaderParams.textureOffsetY=this.webGL.getUniformLocation(t,"aTextureOffsetY"),this.shaderParams.mMatrixToShader=this.webGL.getUniformLocation(t,"uMMatrix"),this.shaderParams.pMatrixToShader=this.webGL.getUniformLocation(t,"uPMatrix"),this.shaderParams.fAlpha=this.webGL.getUniformLocation(t,"fAlpha"),this.shaderParams.isBGRFormat=this.webGL.getUniformLocation(t,"isBGRFormat"),this.webGL.enableVertexAttribArray(this.shaderParams.vertex),this.webGL.enableVertexAttribArray(this.shaderParams.texture),this.webGL_setProgram_TextureSize(1,0,1,0)},webGL_setProgram_ColorFormat:function(t){var e=/iphone|ipod|ipad/gi.test(navigator.platform),i=/AppleWebKit\/(\d+\.\d)/i.test(this.ua)?1*RegExp.$1:null,n=!1;i&&i>=603&&i<604&&(n=!0),e&&n&&t&&"Video"==t.sceneFileType&&"Auto"==t.webGLDrawType?this.webGL.uniform1i(this.shaderParams.isBGRFormat,1):this.webGL.uniform1i(this.shaderParams.isBGRFormat,0)},webGL_setProgram_Matrix:function(t,e,i){var n=t||this.mvMatrix,r=e||this.pMatrix;this.webGL.uniformMatrix4fv(this.shaderParams.mMatrixToShader,!1,n),this.webGL.uniformMatrix4fv(this.shaderParams.pMatrixToShader,!1,r);var s=isNaN(i)?1:i;this.webGL.uniform1f(this.shaderParams.fAlpha,s)},webGL_setProgram_TextureSize:function(t,e,i,n,r){this.webGL.uniform1fv(this.shaderParams.textureScaleX,new Float32Array([t])),this.webGL.uniform1fv(this.shaderParams.textureOffsetX,new Float32Array([e])),this.webGL.uniform1fv(this.shaderParams.textureScaleY,new Float32Array([i])),this.webGL.uniform1fv(this.shaderParams.textureOffsetY,new Float32Array([n]))},webGL_formatTexture:function(t,e){this.webGL.bindTexture(this.webGL.TEXTURE_2D,t),this.webGL.texParameteri(this.webGL.TEXTURE_2D,this.webGL.TEXTURE_MAG_FILTER,this.webGL.LINEAR),this.webGL.texParameteri(this.webGL.TEXTURE_2D,this.webGL.TEXTURE_MIN_FILTER,this.webGL.LINEAR),this.webGL.texParameteri(this.webGL.TEXTURE_2D,this.webGL.TEXTURE_WRAP_S,this.webGL.CLAMP_TO_EDGE),this.webGL.texParameteri(this.webGL.TEXTURE_2D,this.webGL.TEXTURE_WRAP_T,this.webGL.CLAMP_TO_EDGE),this.webGL.texImage2D(this.webGL.TEXTURE_2D,0,this.webGL.RGBA,this.webGL.RGBA,this.webGL.UNSIGNED_BYTE,e),this.webGL.bindTexture(this.webGL.TEXTURE_2D,null)},webGL_clearModelBuffer:function(t){t&&t.vertexBuffer&&(this.webGL.deleteBuffer(t.vertexBuffer),this.webGL.deleteBuffer(t.textureBuffer),this.webGL.deleteBuffer(t.indexBuffer),this.webGL.deleteTexture(t.texture))},webGL_clearAll:function(){for(var t in this.FlatSphere)this.webGL_clearModelBuffer(this.FlatSphere[t]);this.FlatSphere={},this.allCellObj={}},webGL_bindBuffer:function(t){this.webGL.bindBuffer(this.webGL.ARRAY_BUFFER,t.vertexBuffer),this.webGL.vertexAttribPointer(this.shaderParams.vertex,t.vertexBuffer.itemSize,this.webGL.FLOAT,!0,0,0),this.webGL.bindBuffer(this.webGL.ARRAY_BUFFER,t.textureBuffer),this.webGL.vertexAttribPointer(this.shaderParams.texture,t.textureBuffer.itemSize,this.webGL.FLOAT,!0,0,0),this.webGL.bindTexture(this.webGL.TEXTURE_2D,t.texture),this.webGL.bindBuffer(this.webGL.ELEMENT_ARRAY_BUFFER,t.indexBuffer)},webGl_InitDefault:function(){this.api_setDBViewIPD(this.DBViewIPD),this.webGL_setParams(),this.webGL_initCanvas(),this.webGL_initWebGL(),this.webGL_initAllShaders(),this.setInitSize(),this.loadCanvasDom(),this.loadBase64Logo(),this.loadBase64CopyRight()},webGL_start:function(){window.cancelAnimationFrame(this.loopHander),this.webGL_loop(),this.isGyro&&this.api_OpenGyro()},webGL_forwardMercator:function(t,e){t=parseFloat(t),e=parseFloat(e);var i=2*t/180,n=Math.log(Math.tan((90+e)*Math.PI/360))/(Math.PI/180);return{x:i,y:n/=180}},webGL_inverseMercator:function(t,e){var i=e/1*180;return[t/2*180,i=180/Math.PI*(2*Math.atan(Math.exp(i*Math.PI/180))-Math.PI/2)]},webGL_RUpdate:function(){this.eventKeyCode&&this.keyDownLoop(),this.isEventWheel&&this.mouseWheelLoop(),this.dragMode&&this.isEventDown&&this.autoDrag(),this.webGL_useProgram();for(var t=0;t<this.sceneObjList.length;t++){var e=this.sceneObjList[t];this.webGL_setProgram_ColorFormat(e),e.loadOver&&e.draw()}},webGL_drawLogo:function(){var t=this.LogoModelObj,e=mat4.create(),i=mat4.create(),n=this.webGL_getViewPortSize();this.webGL_setProgram_Matrix(i,e),this.webGL_bindBuffer(t),this.webGL_setProgram_TextureSize(1,0,1,0,1),this.webGL.viewport(n.w-t.vLeft,n.h-t.vTop,t.vWidth,t.vHeight),this.webGL.drawElements(this.webGL.TRIANGLES,t.indexBuffer.numItems,this.webGL.UNSIGNED_SHORT,0)},webGL_drawCopyright:function(){var t=this.CopyRightModelObj,e=mat4.create(),i=mat4.create(),n=this.webGL_getViewPortSize();this.webGL_setProgram_Matrix(i,e),this.webGL_bindBuffer(t),this.webGL_setProgram_TextureSize(1,0,1,0,1),this.webGL.viewport(n.w/2-t.vWidth/2,n.h/2-t.vHeight/2,t.vWidth,t.vHeight),this.webGL.drawElements(this.webGL.TRIANGLES,t.indexBuffer.numItems,this.webGL.UNSIGNED_SHORT,0)},webGL_Flat:function(t){var e=t.indexBuffer.numItems,i=this.webGL_getViewPortSize(),n=mat4.create(),r=mat4.create();if(this.webGL_setProgram_Matrix(n,r,t.Alpha),this.webGL_setProgram_TextureSize(1,0,1,0),this.isDBViewPort)if(i.w>i.h){s=JTUtil.getBestFitSize(t.sceneWidth,t.sceneHeight,.5*i.w,i.h);this.webGL.viewport(s.left,s.top,s.width,s.height),this.webGL.drawElements(this.webGL.TRIANGLES,e,this.webGL.UNSIGNED_SHORT,0),this.webGL.viewport(.5*i.w+s.left,s.top,s.width,s.height),this.webGL.drawElements(this.webGL.TRIANGLES,e,this.webGL.UNSIGNED_SHORT,0)}else{s=JTUtil.getBestFitSize(t.sceneWidth,t.sceneHeight,i.w,.5*i.h);this.webGL.viewport(s.left,s.top,s.width,s.height),this.webGL.drawElements(this.webGL.TRIANGLES,e,this.webGL.UNSIGNED_SHORT,0),this.webGL.viewport(s.left,s.top+.5*i.h,s.width,s.height),this.webGL.drawElements(this.webGL.TRIANGLES,e,this.webGL.UNSIGNED_SHORT,0)}else{var s=JTUtil.getBestFitSize(t.sceneWidth,t.sceneHeight,i.w,i.h);this.webGL.viewport(s.left,s.top,s.width,s.height),this.webGL.drawElements(this.webGL.TRIANGLES,e,this.webGL.UNSIGNED_SHORT,0)}},webGL_drawSphere:function(t){"2D"==t.sceneFormat?this.webGL_draw2DSphere(t):this.webGL_draw3DSphere(t),this.sceneBlockModel&&this.webGL_drawAllFlatSphere()},webGL_draw2DSphere:function(t){var e=t.indexBuffer.numItems,i=this.webGL_getViewPortSize();this.webGL_setProgram_Matrix(t.mvMatrix,t.pMatrix,t.Alpha),this.webGL_setProgram_TextureSize(1,0,1,0),this.isDBViewPort?i.w>i.h?(this.webGL.viewport(0,0,.5*i.w,i.h),this.leftM&&this.webGL_setProgram_Matrix(this.hmdMatrix,this.leftM,t.Alpha),this.webGL.drawElements(this.webGL.TRIANGLES,e,this.webGL.UNSIGNED_SHORT,0),this.webGL.viewport(.5*i.w,0,.5*i.w,i.h),this.rightM&&this.webGL_setProgram_Matrix(this.hmdMatrix,this.rightM,t.Alpha),this.webGL.drawElements(this.webGL.TRIANGLES,e,this.webGL.UNSIGNED_SHORT,0)):(this.webGL.viewport(0,0,i.w,.5*i.h),this.leftM&&this.webGL_setProgram_Matrix(this.hmdMatrix,this.leftM,t.Alpha),this.webGL.drawElements(this.webGL.TRIANGLES,e,this.webGL.UNSIGNED_SHORT,0),this.webGL.viewport(0,.5*i.h,i.w,.5*i.h),this.rightM&&this.webGL_setProgram_Matrix(this.hmdMatrix,this.rightM,t.Alpha),this.webGL.drawElements(this.webGL.TRIANGLES,e,this.webGL.UNSIGNED_SHORT,0)):(this.webGL.viewport(0,0,i.w,i.h),this.webGL.drawElements(this.webGL.TRIANGLES,e,this.webGL.UNSIGNED_SHORT,0))},webGL_draw3DSphere:function(t){var e=this.webGL_getViewPortSize(),i=t.sceneFormat,n=t.indexBuffer.numItems;this.webGL_setProgram_Matrix(t.mvMatrix,t.pMatrix,t.Alpha),this.isDBViewPort?e.w>e.h?("LR3D"==i&&this.webGL_setProgram_TextureSize(.5,0,1,0),"UD3D"==i&&this.webGL_setProgram_TextureSize(1,0,.5,0),this.webGL.viewport(0,0,.5*e.w,e.h),this.webGL.drawElements(this.webGL.TRIANGLES,n,this.webGL.UNSIGNED_SHORT,0),"LR3D"==i&&this.webGL_setProgram_TextureSize(.5,.5,1,0),"UD3D"==i&&this.webGL_setProgram_TextureSize(1,0,.5,.5),this.webGL.viewport(.5*e.w,0,.5*e.w,e.h),this.webGL.drawElements(this.webGL.TRIANGLES,n,this.webGL.UNSIGNED_SHORT,0)):("LR3D"==i&&this.webGL_setProgram_TextureSize(.5,0,1,0),"UD3D"==i&&this.webGL_setProgram_TextureSize(1,0,.5,0),this.webGL.viewport(0,0,e.w,.5*e.h),this.webGL.drawElements(this.webGL.TRIANGLES,n,this.webGL.UNSIGNED_SHORT,0),"LR3D"==i&&this.webGL_setProgram_TextureSize(.5,.5,1,0),"UD3D"==i&&this.webGL_setProgram_TextureSize(1,0,.5,.5),this.webGL.viewport(0,.5*e.h,e.w,.5*e.h),this.webGL.drawElements(this.webGL.TRIANGLES,n,this.webGL.UNSIGNED_SHORT,0)):("LR3D"==i&&this.webGL_setProgram_TextureSize(.5,0,1,0),"UD3D"==i&&this.webGL_setProgram_TextureSize(1,0,.5,0),this.webGL.viewport(0,0,e.w,e.h),this.webGL.drawElements(this.webGL.TRIANGLES,n,this.webGL.UNSIGNED_SHORT,0))},webGL_drawPyramid:function(t){var e=this.webGL_getViewPortSize();this.webGL_setProgram_Matrix(t.mvMatrix,t.pMatrix,t.Alpha),this.webGL_setProgram_TextureSize(1,0,1,0),this.isDBViewPort?e.w>e.h?(this.webGL.viewport(0,0,.5*e.w,e.h),this.webGL.drawArrays(this.webGL.TRIANGLES,0,t.vertexBuffer.numItems),this.webGL.viewport(.5*e.w,0,.5*e.w,e.h),this.webGL.drawArrays(this.webGL.TRIANGLES,0,t.vertexBuffer.numItems)):(this.webGL.viewport(0,0,e.w,.5*e.h),this.webGL.drawArrays(this.webGL.TRIANGLES,0,t.vertexBuffer.numItems),this.webGL.viewport(0,.5*e.h,e.w,.5*e.h),this.webGL.drawArrays(this.webGL.TRIANGLES,0,t.vertexBuffer.numItems)):(this.webGL.viewport(0,0,e.w,e.h),this.webGL.drawArrays(this.webGL.TRIANGLES,0,t.vertexBuffer.numItems))},webGL_drawAllFlatSphere:function(){if(!JTUtil.isEmptyObject(this.FlatSphere)){var t=this.webGL_getViewPortSize();for(var e in this.webGL_setProgram_Matrix(),this.webGL_setProgram_TextureSize(1,0,1,0),this.FlatSphere){var i=this.FlatSphere[e];this.webGL_drawFlatSphere(i,t,e)}}},webGL_drawFlatSphere:function(t,e,i){var n=t.indexBuffer.numItems;this.webGL_bindBuffer(t),this.isDBViewPort?e.w>e.h?(this.webGL.viewport(0,0,.5*e.w,e.h),this.webGL.drawElements(this.webGL.TRIANGLES,n,this.webGL.UNSIGNED_SHORT,0),this.webGL.viewport(.5*e.w,0,.5*e.w,e.h),this.webGL.drawElements(this.webGL.TRIANGLES,n,this.webGL.UNSIGNED_SHORT,0)):(this.webGL.viewport(0,0,e.w,.5*e.h),this.webGL.drawElements(this.webGL.TRIANGLES,n,this.webGL.UNSIGNED_SHORT,0),this.webGL.viewport(0,.5*e.h,e.w,.5*e.h),this.webGL.drawElements(this.webGL.TRIANGLES,n,this.webGL.UNSIGNED_SHORT,0)):(this.webGL.viewport(0,0,e.w,e.h),this.webGL.drawElements(this.webGL.TRIANGLES,n,this.webGL.UNSIGNED_SHORT,0))},webGL_getBuffer:function(t){return"Sphere"==t.sceneModel?this.webGL_getSphereBuffer():"Pyramid"==t.sceneModel?this.webGL_getPyramidBuffer():"Flat"==t.sceneModel?this.webGL_getFlatBuffer():void 0},webGL_getSphereBuffer:function(){for(var t=[],e=[],i=[],n=[],r=0;r<=36;r++)for(var s=r*Math.PI/36,a=Math.sin(s),o=Math.cos(s),h=0;h<=72;h++){var l=2*h*Math.PI/72,c=Math.sin(l),u=Math.cos(l)*a,d=o,f=c*a,p=h/72,v=r/36;if(e.push(u),e.push(d),e.push(f),i.push(p),i.push(v),t.push(1*u),t.push(1*d),t.push(1*f),36!=r&&72!=h){var m=73*r+h,w=m+72+1;n.push(m),n.push(w),n.push(m+1),n.push(w),n.push(w+1),n.push(m+1)}}return{normalData:e,textureData:i,vertexData:t,indexData:n}},webGL_getFlatBuffer:function(){return{vertexData:[-1,-1,0,1,-1,0,-1,1,0,1,1,0],textureData:[0,1,1,1,0,0,1,0],indexData:[0,1,2,1,3,2]}},webGL_getPyramidBuffer:function(){Math.sqrt(Math.pow(5,2)+Math.pow(5,2));var t=Math.sqrt(Math.pow(5,2)+Math.pow(5,2))/2,e=5*t/(Math.sqrt(Math.pow(5,2)+Math.pow(t,2))+t);return{vertexData:[0,0,e-5,-5,0,e,0,-5,e,0,0,e-5,0,-5,e,5,0,e,0,0,e-5,5,0,e,0,5,e,0,0,e-5,0,5,e,-5,0,e,-5,0,e,0,5,e,0,-5,e,0,-5,e,0,5,e,5,0,e],textureData:[1,1,1,.5,.5,1,0,1,.5,1,0,.5,0,0,0,.5,.5,0,1,0,.5,0,1,.5,1,.5,.5,0,.5,1,.5,1,.5,0,0,.5],indexData:[0,1,2]}},webGL_getFlatSphereBufferBySize:function(t,e,i,n,r,s){for(var a=[],o=[],h=[],l=t+r/2,c=e+s/2,u=(t+r-t)/24,d=(e+s-e)/24,f=[],p=0;p<=24;p++)for(var v=(t+u*p)*Math.PI/i,m=Math.sin(v),w=Math.cos(v),g=0;g<=24;g++){var b=2*(e+d*g)*Math.PI/n,L=Math.sin(b),y=Math.cos(b)*m,S=w,E=L*m;a.push(1*y),a.push(1*S),a.push(1*E),0==p&&0==g&&(f.push(y),f.push(S),f.push(E)),0==p&&12==g&&(f.push(y),f.push(S),f.push(E)),0==p&&24==g&&(f.push(y),f.push(S),f.push(E)),12==p&&0==g&&(f.push(y),f.push(S),f.push(E)),12==p&&12==g&&(f.push(y),f.push(S),f.push(E)),12==p&&24==g&&(f.push(y),f.push(S),f.push(E)),24==p&&0==g&&(f.push(y),f.push(S),f.push(E)),24==p&&12==g&&(f.push(y),f.push(S),f.push(E)),24==p&&24==g&&(f.push(y),f.push(S),f.push(E))}for(S=0;S<=24;S++)for(y=0;y<=24;y++){var M=y/24,D=S/24;o.push(M),o.push(D)}for(S=0;S<24;S++)for(y=0;y<24;y++){var T=25*S+y,G=T+24+1;h.push(T),h.push(G),h.push(T+1),h.push(G),h.push(G+1),h.push(T+1);M=y/24,D=S/24;o.push(M),o.push(D)}var x=[];v=l*Math.PI/i,m=Math.sin(v),w=Math.cos(v),b=2*c*Math.PI/n,L=Math.sin(b),y=Math.cos(b)*m,S=w,E=L*m;return x.push(1*y),x.push(1*S),x.push(1*E),{textureData:o,vertexData:a,indexData:h,centerData:x,checkData:f}},webGL_getSphereBufferByPT:function(t,e,i,n){for(var r=[],s=[],a=[],o=[],h=1*(1e4*t).toFixed(0),l=1*(1e4*e).toFixed(0),c=t+i/2,u=e+n/2,d=(h+1*(1e4*i).toFixed(0)-h)/48,f=(l+1*(1e4*n).toFixed(0)-l)/48,p=0;p<=48;p++)for(var v=(h+d*p)/1e4*Math.PI/180,m=Math.sin(v),w=Math.cos(v),g=0;g<=48;g++){var b=(l+f*g)/1e4*2*Math.PI/360,L=Math.sin(b),y=Math.cos(b)*m,S=w,E=L*m;s.push(y),s.push(S),s.push(E),r.push(1*y),r.push(1*S),r.push(1*E)}for(S=0;S<=48;S++)for(y=0;y<=48;y++){var M=y/48,D=S/48;a.push(M),a.push(D)}for(S=0;S<48;S++)for(y=0;y<48;y++){var T=49*S+y,G=T+48+1;o.push(T),o.push(G),o.push(T+1),o.push(G),o.push(G+1),o.push(T+1);M=y/48,D=S/48;a.push(M),a.push(D)}var x=[];v=c*Math.PI/180,m=Math.sin(v),w=Math.cos(v),b=2*u*Math.PI/360,L=Math.sin(b),y=Math.cos(b)*m,S=w,E=L*m;return x.push(1*y),x.push(1*S),x.push(1*E),{normalData:s,textureData:a,vertexData:r,indexData:o,centerData:x}},webGL_setParams:function(){this.webGL=null,this.webGLCanvas=null,this.vShaderSource=["attribute vec3 aVertex; ","attribute vec2 aTexture; ","uniform mat4 uMMatrix; ","uniform mat4 uPMatrix; ","varying vec2 vTexture; ","void main(){ ","   gl_Position = uPMatrix * uMMatrix * vec4(aVertex,1.0); ","   vTexture = aTexture; ","}"],this.b1="iVBORw0KGgoAAAANSUhEUgAAAKoAAABOCAMAAACHfX0kAAAAOVBMVEX",this.b2="1AAAAE3RSTlNACC81BgQeAAIBDBY+KiQROjIckTOrrgAABEZJREFUeF7szjENAAAMArB98+8YFRwkrYLez1BVLVFVVVVVVVVVVQ1v5rblOApD0QgLLAHYjv",this.fShaderSource=["#ifdef GL_ES","#ifdef GL_FRAGMENT_PRECISION_HIGH","precision highp float;","#else","precision mediump float;","#endif","#endif","uniform float fAlpha;","uniform int isBGRFormat;","uniform float aTextureScaleX;","uniform float aTextureScaleY;","uniform float aTextureOffsetX;","uniform float aTextureOffsetY;","uniform sampler2D uSampler;","varying vec2 vTexture;","void main(){","   vec2 tScale = vec2(aTextureScaleX,aTextureScaleY);","   vec2 tOffset = vec2(aTextureOffsetX,aTextureOffsetY);","   vec2 cTexture = (vTexture.xy * tScale.xy) + tOffset.xy;","   vec4 c=texture2D(uSampler,vec2(cTexture.s,cTexture.t),-1.0);","   gl_FragColor=bool(isBGRFormat) ? vec4(c.bgr,c.a*fAlpha) : vec4(c.rgb,c.a*fAlpha);","}"],this.shaderParams={},this.FlatSphere={},this.videoElement=null,this.isPlay=!1,this.sceneObjList=[]},getDrawSceneObjById:function(t){for(var e=null,i=this.sceneObjList.length,n=0;n<i;n++)if(this.sceneObjList[n].sceneId===t){e=this.sceneObjList[n];break}return e},delteDrawSceneObjById:function(t){for(var e=null,i=0,n=0;n<this.sceneObjList.length;n++)if(this.sceneObjList[n].sceneId==t){i=n,e=this.sceneObjList[n];break}e&&(this.webGL_clearModelBuffer(e),this.sceneObjList.splice(i,1))},webGL_setBuffer:function(t,e){var i=e||{};return i.texture=this.webGL.createTexture(),i.textureBuffer=this.webGL.createBuffer(),i.vertexBuffer=this.webGL.createBuffer(),i.indexBuffer=this.webGL.createBuffer(),this.webGL_updateBuffer(t,i),i},webGL_updateBuffer:function(t,e){this.webGL.bindBuffer(this.webGL.ARRAY_BUFFER,e.textureBuffer),this.webGL.bufferData(this.webGL.ARRAY_BUFFER,new Float32Array(t.textureData),this.webGL.STATIC_DRAW),e.textureBuffer.itemSize=2,e.textureBuffer.numItems=.5*t.textureData.length,this.webGL.bindBuffer(this.webGL.ARRAY_BUFFER,e.vertexBuffer),this.webGL.bufferData(this.webGL.ARRAY_BUFFER,new Float32Array(t.vertexData),this.webGL.STATIC_DRAW),e.vertexBuffer.itemSize=3,e.vertexBuffer.numItems=t.vertexData.length/3,this.webGL.bindBuffer(this.webGL.ELEMENT_ARRAY_BUFFER,e.indexBuffer),this.webGL.bufferData(this.webGL.ELEMENT_ARRAY_BUFFER,new Uint16Array(t.indexData),this.webGL.STATIC_DRAW),e.indexBuffer.itemSize=1,e.indexBuffer.numItems=t.indexData.length},webGL_getViewPortSize:function(){var t=this.deviceWidth,e=this.deviceHeight,i=t/e;return this.isDBViewPort&&(i=t>e?.5*t/e:t/(.5*e)),{wh:i,w:t,h:e}},webGL_MUpdate:function(t,e){var i=this.getTilt(),n=this.getYFov(),r=this.getPan(),s=this.getCameraAt(),a=(this.getCameraAtAll(),this.webGL_getViewPortSize().wh);if(this.pMatrix=mat4.create(),mat4.perspective(this.pMatrix,this.degToRad(n),a,.001,1e3),mat4.translate(this.pMatrix,this.pMatrix,[0,0,s]),t){t.rotateX(this.degToRad(i));var o=[t.x,t.y,t.z,t.w];quat.invert(o,o);var h=mat4.fromQuat([],o);mat4.rotateX(h,h,this.degToRad(90)),mat4.rotateY(h,h,this.degToRad(90)),mat4.rotateY(h,h,this.degToRad(r)),this.mvMatrix=h}else{var l=90;"Pyramid"==this.sceneModel&&(l=0),this.mvMatrix=mat4.create(),mat4.rotateX(this.mvMatrix,this.mvMatrix,this.degToRad(-i)),mat4.rotateY(this.mvMatrix,this.mvMatrix,this.degToRad(r+l))}this.sceneBlockModel&&this.debounceFN(),this.scenePanTiltFovChangerCallBack&&this.scenePanTiltFovChangerCallBack()},loadCanvasDom:function(){this.canvasDom=JTUtil.cDom(this.toStrByUniCode([99,97,110,118,97,115])),this.canvasDom.setAttribute("crossorigin","anonymous"),this.canvasCTX=this.canvasDom.getContext("2d"),this.b4="9TMLW3YEFxvSKjLG57xpRGU+bfiNqXK3HdxKhtym",this.b5="bZI+vkTMsdbQb8AOStUJJdeGvE1qlyWfMWppxM+pAK7lzHSlvljsW",this.b6="aimsPtJIywjqohafAm4H7XGoMpyE2G5iE1Qj0r3o16k8YFkhSWOLlBlod+drCCpWJR2PlUXRFhWVDPUAcQ3oqaU0pazEtVSAaEOvZuWiuVFFVEd6Y2otQJmyqDVQkxYD7NYo7Aa8jXqs+JvHViSRT0lZEjETFVJ4UWmLU6UiuVFFVG1o3tRt",this.b7="dK3NUbXgPOQraCbjCi+kfmqF0+BOQMi46RPsgvFW1UHxV55VyNhWwFragi6ukDP0c9lFeA3R4xsuqPikT6+QFIGU4tK9kKOlFF1NqN4RzVHtVLOWxGJ+1w2ZrR3WOrUNXWpQPJGctSRFSAZJPEHFUsfNtzyOcJbV3tiy5dT8lKLXzbiNrsKXCKyrGkS0IP0wlIL4lYleRbubGIinAY0zlqfLVgmemYI+Jv+6BicbU9ombcjLBmqLFkOzkTDIvKee"},loadVideoDom:function(){var t=JTUtil.cDom("video");return t.setAttribute("webkit-playsinline",!0),t.setAttribute("x5-video-player-type","h5"),t.setAttribute("x5-video-player-fullscreen","false"),t.setAttribute("playsinline",!0),t.setAttribute("crossorigin","anonymous"),t.setAttribute("preload","metadata"),t},loadImage:function(t,e,i,n){var r=!0;!1===n&&(r=!1);var s=new Image;r&&(s.crossOrigin="anonymous"),s.onload=function(){e&&e(this)},s.onerror=function(){i&&i(this)},s.src=t},loadVideo:function(t,e,i,n,r,s,a){for(var o in t.seekTime=i||0,t.endPan=s,t.endTilt=a,t.isVideoAutoPlay=r,n)this.videoEvents[o]=EventUtil.addEvent(t,o,n[o].bind(this));return this.loadVideoHLSPath(t,e),t.load(),this.delPlayTip(),t},loadVideoHLSPath:function(t,i){var n=JTUtil.getFileExt(i).substring(0,5),r=i.indexOf("rtmp://");if(".m3u8"==n||".m3u"==n){var s=this;i.indexOf("?");JTUtil.loadResource(i,function(n){if(s.isLivePath=n.indexOf("#EXT-X-ENDLIST")<=0,s.isLivePath&&!s.isLive)s.api_playerError(4);else{var r=i;if(e.isMobile)t.src=r,t.play();else if(window.Hls&&window.Hls.isSupported()){if("macintel"==e.plat&&"safari"==e.type)return void(t.src=r);var a=t,o=new window.Hls({maxBufferLength:15});o.attachMedia(a),o.loadSource(r)}else s.api_playerError(6)}})}else 0===r?(this.isLivePath=!0,this.isLivePath&&!this.isLive?this.api_playerError(4):(t.src=i,window.enableInlineVideo&&window.enableInlineVideo(this.videoElement,!this.videoElement.hasAttribute("muted"),!0))):(t.src=i,window.enableInlineVideo&&window.enableInlineVideo(this.videoElement,!this.videoElement.hasAttribute("muted"),!0))},changeVideoPath:function(t,e,i,n){this.setPlayTip(this.toStrByUniCode([20999,25442,20013,46,46,46,46,46,46])),this.loadVideo(this.videoElement,t,e,{},!0,i,n)},changeScenePath:function(t){var e=this;this.setPlayTip(this.toStrByUniCode([20999,25442,20013,46,46,46,46,46,46]));this.loadImage(t,function(t){e.delPlayTip(),this.sceneWidth=t.width,this.sceneHeight=t.height;var i=e.getDrawSceneObjById(e.sceneId);e.autoSetPlayMode(this.sceneWidth,this.sceneHeight,"Image",i),e.webGL.bindTexture(e.webGL.TEXTURE_2D,i.texture),e.webGL.texImage2D(e.webGL.TEXTURE_2D,0,e.webGL.RGBA,e.webGL.RGBA,e.webGL.UNSIGNED_BYTE,t),e.webGL.bindTexture(e.webGL.TEXTURE_2D,null),e.loadedCallBack&&e.loadedCallBack()},function(){e.setPlayTip(decodeURI(i.tip11))})},loadBase64Logo:function(){this.b8="6NFJJ80mBCzGyDmf0b8bCAnBLBTCZBm1ugc66hTR5066tRRp446ddSpo04ddeqoU0edOupUADquG+pCzikkAAAAAElFTkSuQmCC";var t=this.toStrByUniCode([100,97,116,97,58,105,109,97,103,101,47,112,110,103,59,98,97,115,101,54,52,44]),e=[this.b1,"","","8HAwPk5OTw8PAFAQEEAADAv79HcEwEAAAEAAAzMDCioKD8","Pzd3NzR0NB8enr4+Pjp6emysbHSQ4",this.b2,"","Y2dlMhXdaszqbnfxBljyjsyRgDBJY9PlV5fV5KwxkbVe2Q1JV8amqOIe4ashse5mWlfKanJKigDG+m0uHqQrg1loJ6iEj09LyITLp1te5OXTRZqgEvSHtJZ55dzUSMq5PHTrx5K2XYIwQwWNSgQKFZlRnMMUFYfiGEgr4abhUbyp9myQ+ZdR4Y9QGXUMFyAmWPRANqjShrD+EOpqyB575ryr","oZkUaUtNfPPolqUgub795o9qnkz","ygq59q1N4TF0jhUG","KfQRVnQ4cRdiMqvkDtlfgvojKzSuJRWK0Wo7LVoIaw3ohaM2sqpowIAIiZiL8T1qhPjXKNugDdiAqYiVVlqmVLKY2tARJxFNZSuxYVX6I+6o2o51lKeyMxZTglZMdWkTgKqxjXq0FNtdY2bHX7VdRnRDX17B3S",this.b3,"SUyAMqxeWchVRiVxU70clbEJqcZywjKgCKiK0bmR1NyoTHN9n8T2zCMu0AbR61NrSYpLV",this.b6,this.b7,"","Z0D+8kIWYUQl46hNdlbe3mVufr","08FvrMr","MIRhOVBGVnLDmqN+HtX",this.b4,"WO36JdguSWVdFeQLVLLCmqOuFA+gvYC+ndgXjfpiLT1ckVK8FTyALlBXcsKao8Zj","dKQWM9DOeRw",this.b5,"Ly6Qvo9nnRVh7dm5a+q+9PRGO9GllhiostZVt20oDQLndM5dpaC6tMgLUvQKgPG9C2Bak+Br5Y+XfPoZ","cCJqYHnDYCZ5sXvCzjBf",this.b8],i=this.getDeviceDPI(),n=15/i,r="",s=i,a=this.webGL_getFlatBuffer();!this.LogoModelObj&&(this.LogoModelObj=this.webGL_setBuffer(a)),1===this.CRType?(this.copyRightLogo=this.CRImage,s=1.2,r=t+this.copyRightLogo):(s=2,this.copyRightLogo=e.join("/"),r=t+this.copyRightLogo),this.loadImage(r,function(t){var e=t.width,r=t.height,a=e/s,o=r/s;this.LogoModelObj.vMLT=n,this.LogoModelObj.vWidth=a*i,this.LogoModelObj.vHeight=o*i,this.LogoModelObj.vLeft=a*i+n,this.LogoModelObj.vTop=o*i+n,this.LogoModelObj.sWidth=e,this.LogoModelObj.sHeight=r,this.LogoModelObj.loadOver=!0,this.webGL_formatTexture(this.LogoModelObj.texture,t)}.bind(this),null,!1)},loadBase64CopyRight:function(){var t=document.createElement(this.toStrByUniCode([99,97,110,118,97,115]));t.width=270,t.height=60;var e=t.getContext("2d");e.clearRect(0,0,t.width,t.height),this.setCanvasCTX(e,{font:"14px arial",textAlign:"center",textBaseline:"middle",fillStyle:"white"});var i=this.getVersion();e.fillText(i,135,20);var n=this.toStrByUniCode([169])+unescape("%u4E0A%u6D77%u6770%u56FE%u8F6F%u4EF6%u6280%u672F%u6709%u9650%u516C%u53F8%u7248%u6743%u6240%u6709");e.fillText(n,135,40);var r=this.webGL_getFlatBuffer();this.CopyRightModelObj=this.webGL_setBuffer(r),this.CopyRightModelObj.vWidth=270,this.CopyRightModelObj.vHeight=60,this.CopyRightModelObj.loadOver=!0,this.webGL_formatTexture(this.CopyRightModelObj.texture,t)},webGL_loadImage:function(t){var e=this;this.loadImage(t.sceneFilePath,function(i){t.sceneWidth=i.width||t.sceneWidth,t.sceneHeight=i.height||t.sceneHeight,e.autoSetPlayMode(t),e.webGL_imageOver(i,t),e.delPlayTip(),e.sendInfo(t)},function(){e.setPlayTip(decodeURI(i.tip11))})},webGL_imageOver:function(t,e){this.webGL_formatTexture(e.texture,t),this.playDomShow(e),e.loadOver=!0},webGL_loadAllBlockObj:function(){if(this.sceneBlockModel){for(var t=this.sceneBlockModel.sceneWidth,e=this.sceneBlockModel.sceneHeight,i=this.sceneBlockModel.fileBlockWidth,n=this.sceneBlockModel.fileBlockHeight,r=Math.ceil(t/i),s=Math.ceil(e/n),a=e%n,o=t%i,h=0;h<s;h++)for(var l=0;l<r;l++){var c=0!==a&&h==s-1?a:n,u=0!==o&&l==r-1?o:i;this.allCellObj[h+"_"+l]=this.webGL_getFlatSphereBufferBySize(h*n,l*i,e,t,c,u)}this.webGL_updateBlockImage()}},webGL_loadVideo:function(n){this.videoElement=this.loadVideoDom(),this.errorStatus=!1,this.isVideoAutoPlay=!e.isMobile&&this.isVideoAutoPlay,this.videoEvents={};var r={},s=!0,a=!0,o=0,h=this.videoElement;r.loadstart=function(){s=!0,a=!0,o=0,this.setPlayTip(decodeURI(i.tip0[t])),this.videoLoadStartCallBack&&this.videoLoadStartCallBack()},r.loadeddata=function(t){n.sceneWidth=h.videoWidth||1920,n.sceneHeight=h.videoHeight||960,this.canvasDom.width=n.sceneWidth,this.canvasDom.height=n.sceneHeight,this.autoSetPlayMode(n),this.videoLoadMetaDataCallBack&&this.videoLoadMetaDataCallBack(),this.sendInfo(n),h.isVideoAutoPlay&&this.api_setVideoPlay()},r.progress=function(){this.videoLoadProgressCallBack&&this.videoLoadProgressCallBack()},r.timeupdate=function(){a&&0!=this.videoElement.seekable.length&&0!==this.videoElement.seekable.end(0)&&(o=1*this.videoElement.seekTime,this.isLivePath||0==o||this.api_setVideoCurTime(o),a=!1),this.videoUpdateCallBack&&this.videoUpdateCallBack()},r.play=function(t){this.videoPlayerCallBack&&this.videoPlayerCallBack()},r.canplaythrough=function(t){if(n.loadOver=!0,this.delPlayTip(),s){this.webGL_formatTexture(n.texture,this.canvasDom);var e=this.videoElement.endPan,i=this.videoElement.endTilt;(!isNaN(e)||!isNaN(i))&&this.api_walkThrough(.5,e,i,null,null),this.videoElement.endPan="undefined",this.videoElement.endTilt="undefined",this.videoCanPlayerCallBack&&this.videoCanPlayerCallBack(),this.webGL_updateVideoTexture(n),this.playDomShow(n)}else this.videoCanPlayerCallBack&&this.videoCanPlayerCallBack(),this.webGL_updateVideoTexture(n);s=!1},r.error=function(){this.errorCallBack&&this.errorCallBack(1)},r.ended=function(){n.isVideoLoop?this.api_setVideoPlay():this.videoPlayEndCallBack&&this.videoPlayEndCallBack()};var l=/TBS\/(\d+)/i.test(this.ua)?1*RegExp.$1:null,c=/MQQBrowser\/(\d+\.\d)/i.test(this.ua)?1*RegExp.$1:null;l>=36900||c>=7.2?(r.x5videoexitfullscreen=function(){this.api_setVideoPause(),this.X5VideoExitFullscreen&&this.X5VideoExitFullscreen()},r.x5videoenterfullscreen=function(){this.X5VideoEnterFullscreen&&this.X5VideoEnterFullscreen()}):r.x5videoenterfullscreen=function(){this.api_setVideoPause()},this.isBlackWebGL?this.api_playerError(3):(this.loadVideo(this.videoElement,n.sceneFilePath,0,r,!1),this.isVideoAutoPlay&&this.api_setVideoPlay())},webGL_getViewCenter:function(){var t,e;return this.isDBViewPort?this.width>this.height?(t=.5*this.width,e=this.height):(t=this.width,e=.5*this.height):(t=.5*this.width,e=.5*this.height),{width:t,height:e}},webGL_updateBlockImage:function(){if(!JTUtil.isEmptyObject(this.allCellObj)){var t=[],e=this.webGL_getViewCenter(),i={x:e.width,y:e.height};for(var n in this.allCellObj){var r=this.allCellObj[n],s=this.api_3DXYZArrToScreen(r,n);if(s.isInner){var a=this.pointDistance(s,i),o={sId:this.sceneId,key:n,cellData:r,position:a};t.push(o),delete this.allCellObj[n]}}0!==t.length&&(t.sort(function(t,e){return t.position>e.position?1:-1}),this.loopLoadImage(t,0))}},loopLoadImage:function(t,e){var i=t[e];if(i&&i.sId==this.sceneId){var n=i.key.split("_"),r=n[0],s=n[1];if("7niu"==this.sceneBlockModel.fileBlockType)var a=this.sceneBlockModel.fileBlockWidth,o=this.sceneBlockModel.fileBlockHeight,h=a+"x"+o+"a"+s*a+"a"+r*o,l=this.sceneBlockModel.fileBlockDir+h;else{var c=r+"_"+s+".jpg";l=this.sceneBlockModel.fileBlockDir+c}this.loadImage(l,function(n){i.sId==this.sceneId&&(this.webGL_updateSubImageTexture(n,r,s,i.cellData),e+=1,this.loopLoadImage(t,e))}.bind(this))}},webGL_updateSubImageTexture:function(t,e,i,n){var r=this.webGL_setBuffer(n);this.webGL_formatTexture(r.texture,t),this.FlatSphere[e+"_"+i]=r},webGL_updateVideoTexture:function(t){if(t&&!this.errorStatus){var e,i=this.webGL;"Canvas"==t.webGLDrawType?(this.canvasCTX.drawImage(this.videoElement,0,0,this.canvasDom.width,this.canvasDom.height),e=this.canvasDom):e=this.videoElement;try{i.bindTexture(i.TEXTURE_2D,t.texture),i.texImage2D(i.TEXTURE_2D,0,i.RGBA,i.RGBA,i.UNSIGNED_BYTE,e),i.bindTexture(i.TEXTURE_2D,null)}catch(t){this.api_playerError(2)}}},webGL_loop:function(){this.webGL.clear(this.webGL.COLOR_BUFFER_BIT|this.webGL.DEPTH_BUFFER_BIT);var t=this.getDrawSceneObjById(this.sceneId);r.update(),this.webGL_RUpdate(),this.isShowSDK&&this.LogoModelObj.loadOver&&this.webGL_drawLogo(),this.isShowCR&&this.LogoModelObj.loadOver&&this.webGL_drawCopyright(),t&&t.loadOver&&this.drawWebGLCallBack&&this.drawWebGLCallBack(),this.loopHander=requestAnimationFrame(this.webGL_loop.bind(this))},checkSDKSize:function(){var t=this.LogoModelObj.sWidth,e=this.LogoModelObj.sHeight;!(160===t&&48===e||170===t&&78===e)&&this.api_playerError(5)},checkSDKInfo:function(){if(this.copyRightLogo){var t=this.copyRightLogo.charAt(51),e=this.copyRightLogo.charAt(88);!("M"===t&&"A"===e||"B"===t&&"U"===e)&&this.api_playerError(5)}else this.api_playerError(5)},SDKClickEvent:function(t){var e,i=this.getDeviceDPI(),n=EventUtil.getOffsetX(t),r=EventUtil.getOffsetY(t),s=this.LogoModelObj.vMLT/i,a=this.LogoModelObj.vWidth/i,o=this.LogoModelObj.vHeight/i,h=this.width;r>s&&r<o+s&&n>h-a-s&&n<h-s&&(e=1===this.CRType?[104,116,116,112,58,47,47,119,119,119,46,106,105,101,116,117,115,111,102,116,46,99,111,109]:[104,116,116,112,58,47,47,119,119,119,46,106,105,101,116,117,115,111,102,116,46,99,111,109,47,116,114,97,99,107,47,114,101,100,105,114,101,99,116,46,97,115,112,120,63,102,114,111,109,61,115,100,107,45,99,111,112,121,114,105,103,104,116,38,116,111,61,104,116,116,112,37,51,65,37,50,70,37,50,70,119,119,119,46,117,116,111,118,114,46,99,111,109,37,50,70,100,101,118,101,108,111,112,101,114,99,101,110,116,101,114,37,50,70],window.open(this.toStrByUniCode(e)))},setCanvasCTX:function(t,e){for(var i in e)t[i]=e[i]},getFovLength:function(){var t;return t="XFov"==this.fovType?this.width:"YFov"==this.fovType?this.height:this.width>this.height?this.width:this.height,this.fovLength=t/(2*Math.tan(Math.PI/180*(.5*this.curFov))),this.fovLength},getYFov:function(){return"YFov"==this.fovType?this.curFov:"XFov"==this.fovType?180*Math.atan(.5*this.height/this.fovLength)/Math.PI*2:this.width>this.height?180*Math.atan(.5*this.height/this.fovLength)/Math.PI*2:this.curFov},getFov:function(){return this.curFov},getTilt:function(){return this.curTilt},getPan:function(){return this.curPan},getRoll:function(){return this.curRoll},getCameraAt:function(){return this.cameraAt},getCameraAtAll:function(){return{x:this.cameraAtX||0,y:this.cameraAtY||0,z:this.cameraAtZ||0}},api_setCameraAtAll:function(t,e,i){this.cameraAtX=t||0,this.cameraAtY=e||0,this.cameraAtZ=i||0,this.webGL_MUpdate()},setCameraAt:function(t){this.cameraAt=t},checkTilt:function(t){var e=this.maxTilt,i=this.minTilt,n=isNaN(t)?this.getTilt():t;if(90==e&&-90==i)return n>e-1&&(n=e-1),n<i+1&&(n=i+1),void(this.curTilt=n);var r=this.width/this.height,s=this.getFov(),a=2*Math.atan(Math.tan(s*Math.PI/360)/r)*180/Math.PI;if(a>Math.abs(e-i)-2)return a=Math.abs(e-i)-2,this.curFov=2*Math.atan(Math.tan(a*Math.PI/360)*r)*180/Math.PI,void(this.curTilt=.5*(e+i));if(e-i<180){var o=e-.5*a,h=i+.5*a;return 90!=e&&(n=n>o?o:n),-90!=i&&(n=n<h?h:n),n>e-1&&(n=e-1),n<i+1&&(n=i+1),void(this.curTilt=n)}},checkFov:function(t){var e=this.minFov,i=this.maxFov;this.curFov=isNaN(t)?this.getFov():t,this.curFov<e&&(this.curFov=e),this.curFov>i&&(this.curFov=i),this.getFovLength()},checkPan:function(t){this.curPan=isNaN(t)?this.getPan():t,this.curPan=this.curPan%360,this.curPan<0&&(this.curPan=this.curPan+360)},checkPanTiltFov:function(){this.checkPan(),this.checkTilt(),this.checkFov()},setPanTiltFov:function(t,e,i){this.checkPan(t),this.checkTilt(e),this.checkFov(i),this.checkPanTiltFov(),this.changerCallBack()},setPanTilt:function(t,e){this.checkTilt(e),this.checkPan(t),this.changerCallBack()},setFovOnly:function(t){this.checkFov(t),this.checkPanTiltFov(),this.changerCallBack()},setPanOnly:function(t){this.checkPan(t),this.changerCallBack()},setTiltOnly:function(t){this.checkTilt(t),this.changerCallBack()},changerCallBack:function(){!this.isGyro&&this.webGL_MUpdate()},changerCallBackByGyro:function(t,e){this.webGL_MUpdate(t,e)},onResizePlay:function(){this.updateVerTip(),this.checkPanTiltFov(),this.webGL_resizeWebGl(),this.webGL_MUpdate()},addEventHanders:function(t){"mover"==this.dragStarMode?EventUtil.addEvent(t,"mouseover",this.mouseOver,this):EventUtil.addEvent(t,"mousedown",this.mouseDown,this),EventUtil.addEvent(t,"touchstart",this.mouseDown,this),EventUtil.addEvent(document,"fullScreenChange",function(){this.fullScreenChangeCallBack&&this.fullScreenChangeCallBack()},this),"pc"==e.pc&&(EventUtil.addEvent(t,"keydown",this.onDomKeyDown,this),EventUtil.addEvent(document,"keydown",this.onKeyDown,this),EventUtil.addEvent(document,"keyup",this.onKeyUp,this),EventUtil.addEvent(document,"keydown",function(t){t.altKey&&t.shiftKey&&t.ctrlKey&&86==t.keyCode&&(this.isShowCR=!this.isShowCR)},this),EventUtil.addEvent(this.target,"contextmenu",function(t){EventUtil.stopDefault(t),this.isEventDown=!1,this.isRightClick&&this.showRightClass(t,this.getVersion())},this),EventUtil.addEvent(document,"click",this.hiddenRightClass,this),this.isMouseWheel&&EventUtil.addEvent(t,"mousewheel",this.mouseWheel,this),this.isDBClick&&EventUtil.addEvent(t,"dblclick",this.api_fullScreen,this),this.moveCallBackEH=EventUtil.addEvent(t,"mousemove",this.addMoveCallBackEvent,this)),this.debounceFN=EventUtil.throttle(this.webGL_updateBlockImage,100,!1,!1).bind(this)},onKeyUp:function(t){this.clearOtherLoop()},onDomKeyDown:function(t){32==t.keyCode&&(EventUtil.stopDefault(t),this.api_setVideoToggle())},onKeyDown:function(t){var e=t.keyCode;if(this.eventKeyCode!=e)switch(e){case 37:this.api_left();break;case 38:EventUtil.stopDefault(t),this.api_up();break;case 39:this.api_right();break;case 40:EventUtil.stopDefault(t),this.api_down()}},mouseOver:function(t){this.initDragStart(t),this.addPlayDomEvent()},mouseDown:function(t){2!=EventUtil.getButton(t)&&(this.initDragStart(t),this.addPlayDomEvent())},addMoveCallBackEvent:function(t,e){this.sceneEventMoveCallBack&&this.sceneEventMoveCallBack(t)},mouseMove:function(t,e){if(this.isDragAble&&this.isEventDown){EventUtil.stopDefault(e);var i=EventUtil.getEventSize(t);this.curDragX=i.x,this.curDragY=i.y,this.initDragMove()}},touchMove:function(t,e){var i=e.targetTouches.length;if(1==i)this.startScaleNum=0,this.mouseMove(t,e);else if(2==i&&this.isMouseWheel){EventUtil.stopDefault(e),this.isEventDown=!1;var n=e.targetTouches,r={x:n[0].clientX,y:n[0].clientY},s={x:n[1].clientX,y:n[1].clientY},a=this.pointDistance(r,s);0==this.startScaleNum&&(this.startScaleNum=a);var o=this.startScaleNum/a;this.startScaleNum=a,this.gestureChange(o)}},mouseUp:function(t){2!=EventUtil.getButton(t)&&(this.initDragUp(t),this.removePlayDomEvent()),this.startScaleNum=0},mouseOut:function(t){this.isEventDown=!1,this.removePlayDomEvent()},addPlayDomEvent:function(){var t=this.playDom;this.touchmoveEH=EventUtil.addEvent(t,"touchmove",this.touchMove,this),this.touchendEH=EventUtil.addEvent(t,"touchend",this.mouseUp,this),this.mousemoveEH=EventUtil.addEvent(t,"mousemove",this.mouseMove,this),"mdown"==this.dragStarMode&&(this.mouseupEH=EventUtil.addEvent(t,"mouseup",this.mouseUp,this)),this.mouseoutEH=EventUtil.addEvent(t,"mouseout",this.mouseOut,this),EventUtil.removeEvent(t,"mousemove",this.moveCallBackEH)},removePlayDomEvent:function(){var t=this.playDom;EventUtil.removeEvent(t,"touchmove",this.touchmoveEH),EventUtil.removeEvent(t,"touchend",this.touchendEH),EventUtil.removeEvent(t,"mousemove",this.mousemoveEH),EventUtil.removeEvent(t,"mouseup",this.mouseupEH),EventUtil.removeEvent(t,"mouseout",this.mouseoutEH),this.moveCallBackEH=EventUtil.addEvent(t,"mousemove",this.addMoveCallBackEvent,this)},mouseWheel:function(t){EventUtil.stopPropagation(t),EventUtil.stopDefault(t);var e=(t.wheelDelta||-t.detail)>0?3:-3;this.countWheelNum+=.375*e,this.isEventWheel=!0},gestureChange:function(t){var e=this.getFov()*t;this.setFovOnly(e)},pointDistance:function(t,e){var i=t.x-e.x,n=t.y-e.y;return Math.sqrt(i*i+n*n)},getMoveSizeForMobile:function(t,e){var i,n;return this.curRoll<45&&this.curRoll>-45?(i=t,n=e):this.curRoll>45&&this.curRoll<135?(i=e,n=-t):Math.abs(this.curRoll)>135?(i=-t,n=-e):this.curRoll<-45&&this.curRoll>-135?(i=-e,n=t):(i=t,n=e),{newpan:i,newtilt:n}},initDragStart:function(t){this.clearOtherLoop(),this.dragMode&&r.remove(this.drawTween);var e=EventUtil.getEventSize(t);this.isEventDown=!0,this.startDragX=this.curDragX=e.x,this.startDragY=this.curDragY=e.y,this.startDTime=(new Date).getTime(),this.sceneEventDownCallBack&&this.sceneEventDownCallBack(t)},initDragMove:function(){var t=this.curDragX-this.startDragX,e=this.curDragY-this.startDragY,i=this.dragDirectionMode?-1:1,n=i*Math.atan(t/this.fovLength)*180/Math.PI,r=i*Math.atan(e/this.fovLength)*180/Math.PI;if(this.dragMode)this.dragSpeedX=n,this.dragSpeedY=r;else{var s=this.getPan()+n,a=this.getTilt()-r;this.setPanTilt(s,a),this.startDragX=this.curDragX,this.startDragY=this.curDragY}},initDragUp:function(t){if(this.isEventDown){if(this.sceneEventUpCallBack&&this.sceneEventUpCallBack(t),this.startEndTime=(new Date).getTime(),this.startEndTime-this.startDTime<150)return this.initClick(t),this.isEventDown=!1,this.startScaleNum=0,this.dragSpeedX=0,void(this.dragSpeedY=0);1==this.dragMode&&this.autoDragStop(this.dragSpeedX,this.dragSpeedY),this.isEventDown=!1,this.startScaleNum=0,this.dragSpeedX=0,this.dragSpeedY=0}},initClick:function(t){this.isShowSDK&&this.SDKClickEvent(t),this.sceneEventClickCallBack&&this.sceneEventClickCallBack(t)},autoDrag:function(){var t=this.getPan()+this.dragSpeedX*this.dragSpeed,e=this.getTilt()-this.dragSpeedY*this.dragSpeed;this.setPanTilt(t,e)},autoDragStop:function(t,e){var i=this.dragSpeed,n=t,s=e,a=this;this.drawTween=new r.Tween({s:i}).to({s:0},300).onUpdate(function(){var t=a.getPan()+n*this.s,e=a.getTilt()-s*this.s;a.setPanTilt(t,e)}).start()},keyDownLoop:function(t){var e=this.eventKeyCode;if(0!=e){var i,n,r,s=t||.05*this.sceneSpeed;switch(e){case 37:i=this.getPan()-s,this.setPanOnly(i);break;case 39:i=this.getPan()+s,this.setPanOnly(i);break;case 38:n=this.getTilt()+s,this.setTiltOnly(n);break;case 40:n=this.getTilt()-s,this.setTiltOnly(n);break;case 16:r=this.getFov()-s,this.setFovOnly(r);break;case 17:r=this.getFov()+s,this.setFovOnly(r)}}},mouseWheelLoop:function(){this.countWheelNum*=.875,this.curFov-=this.countWheelNum,Math.abs(this.countWheelNum)<.125?(this.countWheelNum=0,this.isEventWheel=!1):this.setFovOnly()},clearOtherLoop:function(){this.isEventWheel=!1,this.eventKeyCode=0},hiddenRightClass:function(){JTUtil.gId("TWP_rightTarget")&&DomUtil.destroy(JTUtil.gId("TWP_rightTarget"))},showRightClass:function(e,n){this.hiddenRightClass();var r=JTUtil.cDom("div");DomUtil.setStyles(r,{position:"absolute",zIndex:9999,opacity:.9999,visibility:"hidden",border:"4px solid #f1f1f1",backgroundColor:"rgba(233, 232, 232,0.67)",width:"256px",boxShadow:"rgba(0, 0, 0, 0.5) 0px 0px 4px"}),DomUtil.setProperties(r,{id:"TWP_rightTarget"}),DomUtil.inject(r,this.target),EventUtil.addEvent(r,"contextmenu",function(t){EventUtil.stopPropagation(t),EventUtil.stopDefault(t)});var s=JTUtil.cDom("div");DomUtil.setStyles(s,{position:"relative",backgroundColor:"rgba(233, 232, 232,0.67)",borderRadius:"3px",boxShadow:"#dddddd 0px 0px 2px inset",width:"100%",height:"100%",overflow:"hidden"}),DomUtil.inject(s,r),EventUtil.addEvent(s,"click",this.hiddenRightClass,this);var a=function(t,e){return DomUtil.setStyles(JTUtil.cDom("div"),{position:"absolute",left:e+"px",height:"100%",width:"1px",backgroundColor:t})},o=function(t){return DomUtil.setStyles(JTUtil.cDom("div"),{height:"1px",backgroundColor:t})},h=function(){var e=JTUtil.cDom("div");return DomUtil.setStyles(e,{width:"100%",height:"36px",lineHeight:"36px",color:"#000000",fontSize:"12px",fontFamily:"cn"==t?"SimSun":"Arial,Helvetica,sans-serif",textShadow:"0px 0px 2px white",paddingLeft:"3px",cursor:"pointer",textAlign:"left"}),EventUtil.addEvent(e,"mouseout",function(t){DomUtil.setStyles(e,{backgroundColor:"rgba(255,255,255,0.85)"})}),EventUtil.addEvent(e,"mouseout",function(t){DomUtil.setStyles(e,{backgroundColor:""})}),e};DomUtil.inject(a("#e9e9e9",37),s),DomUtil.inject(a("#fafafa",38),s),DomUtil.inject(a("#cacaca",39),s);var l=JTUtil.cDom("div");DomUtil.setStyles(l,{position:"relative",left:"40px",height:"100%",width:"100%",textAlign:"left"}),DomUtil.inject(l,s);var c,u,d=h();DomUtil.inject(d,l),1===this.CRType?(u=[20851,20110,26480,22270,36719,20214],c=[104,116,116,112,58,47,47,119,119,119,46,106,105,101,116,117,115,111,102,116,46,99,111,109]):(u=[20851,20110,85,116,111,86,82],c=[104,116,116,112,58,47,47,119,119,119,46,106,105,101,116,117,115,111,102,116,46,99,111,109,47,116,114,97,99,107,47,114,101,100,105,114,101,99,116,46,97,115,112,120,63,102,114,111,109,61,115,100,107,45,99,111,112,121,114,105,103,104,116,38,116,111,61,104,116,116,112,37,51,65,37,50,70,37,50,70,119,119,119,46,117,116,111,118,114,46,99,111,109,37,50,70,100,101,118,101,108,111,112,101,114,99,101,110,116,101,114,37,50,70]),d.innerHTML=this.toStrByUniCode(u),EventUtil.addEvent(d,"click",function(){window.open(this.toStrByUniCode(c))},this),DomUtil.inject(o("#cdcdcd"),l),DomUtil.inject(o("#f1f1f1"),l);var f=h();DomUtil.inject(f,l),f.innerHTML=decodeURI(i.tip16[t]),this.isLittlePlanetEffect?EventUtil.addEvent(f,"click",this.api_normalView,this):DomUtil.setStyles(f,{color:"#888787",cursor:"default"});var p=h();DomUtil.inject(p,l),p.innerHTML=decodeURI(i.tip17[t]),this.isLittlePlanetEffect||this.maxTilt-this.minTilt!=180||this.maxPan-this.minPan!=360?DomUtil.setStyles(p,{color:"#888787",cursor:"default"}):EventUtil.addEvent(p,"click",this.api_littlePlanet,this);var v=h();DomUtil.inject(v,l);var m=JTUtil.isFullScreen();v.innerHTML=m?decodeURI(i.tip19[t]):decodeURI(i.tip18[t]),EventUtil.addEvent(v,"click",this.api_fullScreen,this),DomUtil.inject(o("#cdcdcd"),l),DomUtil.inject(o("#f1f1f1"),l);var w=h();DomUtil.setStyles(w,{color:"#888787",cursor:"default"}),DomUtil.inject(w,l),w.innerHTML=n;var g=EventUtil.getEventSize(e),b=this.target.getBoundingClientRect();g.x=g.x-b.left,g.y=g.y-b.top;var L=function(t,e,i,n,r){var s=t.getBoundingClientRect(),a=n,o=r,h=s.width,l=s.height;return a+h>e&&(a-=h),o+l>i&&(o-=l),a<0&&(a=(e-h)/2),o<0&&(o=(i-l)/2),{left:a,top:o}}(r,b.width,b.height,g.x,g.y);DomUtil.setStyles(r,{left:L.left+"px",top:L.top+"px",visibility:"visible"})},show2DVideo:function(t,e){if(t){for(var i in this.videoElement=this.videoElement||this.loadVideoDom(),this.videoEvents)EventUtil.removeEvent(this.videoElement,i,this.videoEvents[i]);!this.videoElement.src&&(this.videoElement.src=this.sceneFilePath),EventUtil.addEvent(this.videoElement,"progress",function(){this.videoLoadProgressCallBack&&this.videoLoadProgressCallBack()}.bind(this)),EventUtil.addEvent(this.videoElement,"timeupdate",function(){this.videoUpdateCallBack&&this.videoUpdateCallBack()}.bind(this)),0===e&&this.videoElement.setAttribute("controls",!0),this.videoElement.setAttribute("loop",!0),DomUtil.setStyles(this.videoElement,{position:"absolute",left:"0px",top:"0px",width:"100%",height:"100%",backgroundColor:"black"});var n=0===e?this.playDom:this.cubeDom;DomUtil.inject(this.videoElement,n)}}});window.JTPlay=a}()}]);